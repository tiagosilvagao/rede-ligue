maskDirectiveAsDate.$inject=["$compile","$translate","$parse"],maskDirectiveMask.$inject=["$compile","$translate","$parse"],function($app){var _Mathfloor=Math.floor;app.common={generateId:function(){var e=_Mathfloor(65536*(1+Math.random())).toString(16).substring(1);return-1<"0123456789".indexOf(e.substr(0,1))?this.generateId():e}};var isoDate=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,ISO_PATTERN=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,patternFormat=function(e){return e?$(e).attr("format")||"DD/MM/YYYY":"DD/MM/YYYY"},parsePermission=function(e){var t={visible:{public:!0},enabled:{public:!0},notvisible:{public:!1},notenabled:{public:!1}};if(e)for(var n,a=e.toLowerCase().trim().split(","),o=0;o<a.length;o++)if(n=a[o].trim(),n){var r=n.split(":");if(2==r.length){var l=r[0].trim(),d=r[1].trim();if(d){for(var s,c=d.split(";"),u={},g=0;g<c.length;g++)s=c[g].trim(),s&&(u[s]=!0);t[l]=u}}}return t};app.directive("asDate",maskDirectiveAsDate).directive("ngDestroy",function(){return{restrict:"A",link:function(scope,element,attrs,ctrl){element.on("$destroy",function(){attrs.ngDestroy&&0<attrs.ngDestroy.length&&(-1<attrs.ngDestroy.indexOf("app.")||-1<attrs.ngDestroy.indexOf("blockly.")?scope.$eval(attrs.ngDestroy):eval(attrs.ngDestroy))})}}}).directive("dynamicImage",["$compile",function(e){return{restrict:"E",replace:!0,scope:{ngModel:"@",width:"@",height:"@",style:"@",class:"@"},require:"ngModel",template:"<div></div>",init:function(e){e.ngModel||(e.ngModel=""),e.width||(e.width="128"),e.height||(e.height="128"),e.style||(e.style=""),e.class||(e.class=""),this.containsLetter(e.width)||(e.width+="px"),this.containsLetter(e.height)||(e.height+="px")},containsLetter:function(e){for(var t,n=0;n<e.length;n++){t=!0;for(var a=0;10>a;a++)parseInt(e[n])==a&&(t=!1);if(t)break}return t},link:function(t,n,a){this.init(t);var o=t,r=a.ngRequired&&"true"==a.ngRequired?"required":"";n.append("<div class=\"form-group upload-image-component\" ngf-drop=\"\" ngf-drag-over-class=\"dragover\">                                  <img class=\"$class$\" style=\"$style$; height: $height$; width: $width$;\" ng-if=\"$ngModel$\" data-ng-src=\"{{$ngModel$.startsWith('http') || ($ngModel$.startsWith('/') && $ngModel$.length < 1000)? $ngModel$ : 'data:image/png;base64,' + $ngModel$}}\">                                  <img class=\"$class$\" style=\"$style$; height: $height$; width: $width$;\" ng-if=\"!$ngModel$\" data-ng-src=\"/plugins/cronapp-framework-js/img/selectImg.svg\" class=\"btn\" ng-if=\"!$ngModel$\" ngf-drop=\"\" ngf-select=\"\" ngf-change=\"cronapi.internal.setFile('$ngModel$', $file)\" accept=\"image/*;capture=camera\">                                  <div class=\"remove btn btn-danger btn-xs\" ng-if=\"$ngModel$\" ng-click=\"$ngModel$=null\">                                    <span class=\"glyphicon glyphicon-remove\"></span>                                  </div>                                  <div class=\"btn btn-info btn-xs start-camera-button\" ng-if=\"!$ngModel$\" ng-click=\"cronapi.internal.startCamera('$ngModel$')\">                                    <span class=\"glyphicon glyphicon-facetime-video\"></span>                                  </div>                                  <input ng-if=\"!$ngModel$\" autocomplete=\"off\" tabindex=\"-1\" class=\"uiSelectRequired ui-select-offscreen\" style=\"top: inherit !important; margin-left: 85px !important;margin-top: 50px !important;\" type=text ng-model=\"$ngModel$\" $required$>                                </div>".split("$height$").join(o.height).split("$width$").join(o.width).split("$ngModel$").join(o.ngModel).split("$style$").join(o.style).split("$class$").join(o.class).split("$required$").join(r)),e(n)(n.scope())}}}]).directive("dynamicImage",["$compile",function(e){return{restrict:"A",scope:!0,require:"ngModel",link:function(t,n,a){var o=a.ngRequired&&"true"==a.ngRequired?"required":"",r=n.html(),l="<div ngf-drop=\"\" ngf-drag-over-class=\"dragover\">           <img style=\"width: 100%;\" ng-if=\"$ngModel$\" data-ng-src=\"{{$ngModel$.startsWith('http') || ($ngModel$.startsWith('/') && $ngModel$.length < 1000)? $ngModel$ : 'data:image/png;base64,' + $ngModel$}}\">           <input ng-if=\"!$ngModel$\" autocomplete=\"off\" tabindex=\"-1\" class=\"uiSelectRequired ui-select-offscreen\" style=\"top: inherit !important; margin-left: 85px !important;margin-top: 50px !important;\" type=text ng-model=\"$ngModel$\" $required$>           <div class=\"btn\" ng-if=\"!$ngModel$\" ngf-drop=\"\" ngf-select=\"\" ngf-change=\"cronapi.internal.setFile('$ngModel$', $file)\" ngf-pattern=\"'image/*'\" ngf-max-size=\"$maxFileSize$\">             $userHtml$           </div>           <div class=\"remove-image-button btn btn-danger btn-xs\" ng-if=\"$ngModel$\" ng-click=\"$ngModel$=null\">             <span class=\"glyphicon glyphicon-remove\"></span>           </div>           <div class=\"btn btn-info btn-xs start-camera-button-attribute\" ng-if=\"!$ngModel$\" ng-click=\"cronapi.internal.startCamera('$ngModel$')\">             <span class=\"glyphicon glyphicon-facetime-video\"></span>           </div>         </div>",d="";a.maxFileSize&&(d=a.maxFileSize),l=$(l.split("$ngModel$").join(a.ngModel).split("$required$").join(o).split("$userHtml$").join(r).split("$maxFileSize$").join(d)),n.html(l),e(l)(n.scope())}}}]).directive("dynamicFile",["$compile",function(e){return{restrict:"A",scope:!0,require:"ngModel",link:function(t,n,a){var o=a.ngRequired&&"true"==a.ngRequired?"required":"",r=a.ngModel.split("."),l=r[0],d=r[r.length-1],s=_Mathfloor(1e3*Math.random()+20),c=n.html(),p="";a.maxFileSize&&(p=a.maxFileSize);var u="                                <div ng-show=\"!$ngModel$\" ngf-drop=\"\" ngf-drag-over-class=\"dragover\">                                  <input ng-if=\"!$ngModel$\" autocomplete=\"off\" tabindex=\"-1\" class=\"uiSelectRequired ui-select-offscreen\" style=\"top: inherit !important;margin-left: 85px !important;margin-top: 50px !important;\" type=text ng-model=\"$ngModel$\" $required$>                                  <div class=\"btn\" ngf-drop=\"\" ngf-select=\"\" ngf-change=\"cronapi.internal.uploadFile('$ngModel$', $file, 'uploadprogress$number$')\" ngf-max-size=\"$maxFileSize$\">                                    $userHtml$                                  </div>                                  <div class=\"progress\" data-type=\"bootstrapProgress\" id=\"uploadprogress$number$\" style=\"display:none\">                                    <div class=\"progress-bar\" role=\"progressbar\" aria-valuenow=\"70\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:0%\">                                      <span class=\"sr-only\"></span>                                    </div>                                  </div>                                </div>                                 <div ng-show=\"$ngModel$\" class=\"upload-image-component-attribute\">                                   <div class=\"btn btn-danger btn-xs ng-scope\" style=\"float:right;\" ng-if=\"$ngModel$\" ng-click=\"$ngModel$=null\">                                     <span class=\"glyphicon glyphicon-remove\"></span>                                   </div>                                   <div>                                     <div ng-bind-html=\"cronapi.internal.generatePreviewDescriptionByte($ngModel$)\"></div>                                     <a href=\"javascript:void(0)\" ng-click=\"cronapi.internal.downloadFileEntity($datasource$,'$field$')\">download</a>                                   </div>                                 </div>                                 ";u=$(u.split("$ngModel$").join(a.ngModel).split("$datasource$").join(l).split("$field$").join(d).split("$number$").join(s).split("$required$").join(o).split("$userHtml$").join(c).split("$maxFileSize$").join(p)),n.html(u),e(u)(n.scope())}}}]).directive("dynamicFile",["$compile",function(e){return{restrict:"E",replace:!0,scope:{ngModel:"@"},require:"ngModel",template:"<div></div>",init:function(e){e.ngModel||(e.ngModel="")},link:function(t,n,a){this.init(t);var o=t,r=a.ngRequired&&"true"==a.ngRequired?"required":"",l=o.ngModel.split("."),d=l[0],s=l[l.length-1],c=_Mathfloor(1e3*Math.random()+20);n.append("                                <div ng-show=\"!$ngModel$\">                                  <input ng-if=\"!$ngModel$\" autocomplete=\"off\" tabindex=\"-1\" class=\"uiSelectRequired ui-select-offscreen\" style=\"top: inherit !important;margin-left: 85px !important;margin-top: 50px !important;\" type=text ng-model=\"$ngModel$\" $required$>                                  <div class=\"form-group upload-image-component\" ngf-drop=\"\" ngf-drag-over-class=\"dragover\">                                     <img class=\"ng-scope\" style=\"height: 128px; width: 128px;\" ng-if=\"!$ngModel$\" data-ng-src=\"/plugins/cronapp-framework-js/img/selectFile.png\" ngf-drop=\"\" ngf-select=\"\" ngf-change=\"cronapi.internal.uploadFile('$ngModel$', $file, 'uploadprogress$number$')\" accept=\"*\">                                    <progress id=\"uploadprogress$number$\" max=\"100\" value=\"0\" style=\"position: absolute; width: 128px; margin-top: -134px;\">0</progress>                                  </div>                                </div>                                 <div ng-show=\"$ngModel$\" class=\"form-group upload-image-component\">                                   <div class=\"btn btn-danger btn-xs ng-scope\" style=\"float:right;\" ng-if=\"$ngModel$\" ng-click=\"$ngModel$=null\">                                     <span class=\"glyphicon glyphicon-remove\"></span>                                   </div>                                   <div>                                     <div ng-bind-html=\"cronapi.internal.generatePreviewDescriptionByte($ngModel$)\"></div>                                     <a href=\"javascript:void(0)\" ng-click=\"cronapi.internal.downloadFileEntity($datasource$,'$field$')\">download</a>                                   </div>                                 </div>                                 ".split("$ngModel$").join(o.ngModel).split("$datasource$").join(d).split("$field$").join(s).split("$number$").join(c).split("$required$").join(r)),e(n)(n.scope())}}}]).directive("pwCheck",[function(){'use strict';return{require:"ngModel",link:function(e,t,n,a){var o="#"+n.pwCheck;t.add(o).on("keyup",function(){e.$apply(function(){var e=t.val()===$(o).val();a.$setValidity("pwmatch",e)})})}}}]).directive("ngClick",[function(){'use strict';return{link:function(scope,elem,attrs,ctrl){if(scope.rowData){var crnDatasource=elem.closest("[crn-datasource]");0<crnDatasource.length&&elem.on("click",function(){scope.$apply(function(){var datasource=eval(crnDatasource.attr("crn-datasource"));datasource.active=scope.rowData})})}}}}]).directive("valid",function(){return{require:"^ngModel",restrict:"A",link:function(e,t,n,a){var o={cpf:CPF,cnpj:CNPJ};a.$validators[n.valid]=function(e,a){var r=e||a,l=o[n.valid].isValid(r);return l?t[0].setCustomValidity(""):t.scope().$applyAsync(function(){t[0].setCustomValidity(t[0].dataset.errorMessage)}),l||!r}}}}).directive("cronappSecurity",function(){return{restrict:"A",link:function(e,t,n){var a=[],o=JSON.parse(localStorage.getItem("_u"));o&&o.roles&&(a=o.roles.toLowerCase().split(","));for(var r,l=parsePermission(n.cronappSecurity),d=!1,s=!1,c=0;c<a.length;c++)r=a[c].trim(),r&&(l.visible[r]&&(d=!0),l.enabled[r]&&(s=!0));for(var r,c=0;c<a.length;c++)r=a[c].trim(),r&&(l.notvisible[r]&&(d=!1),l.notenabled[r]&&(s=!1));d||$(t).hide(),s||$(t).find("*").addBack().attr("disabled",!0)}}}).directive("qr",["$window",function(e){return{restrict:"A",require:"^ngModel",template:"<canvas ng-hide=\"image\"></canvas><img ng-if=\"image\" ng-src=\"{{canvasImage}}\"/>",link:function(t,n,a,o){t.size===void 0&&a.size&&(t.text=a.size);var r=function(){return o.$modelValue||""},l=function(e){var t=/^[0-9]*$/;return t.test(e)},d=function(e){var t=/^[0-9A-Z $%*+\-./:]*$/;return t.test(e)},s=function(e){for(var t,n=0;n<e.length;n++)if(t=e.charCodeAt(n),255<t)return!1;return!0},c=function(e,t){if("NUMBER"===e&&!l(t))throw new Error("The `NUMBER` input mode is invalid for text.");else if("ALPHA_NUM"===e&&!d(t))throw new Error("The `ALPHA_NUM` input mode is invalid for text.");else if("8bit"===e&&!s(t))throw new Error("The `8bit` input mode is invalid for text.");else if(!s(t))throw new Error("Input mode is invalid for text.");return!0},p=function(e){var n=t.inputMode;return n=n||(l(e)?"NUMBER":void 0),n=n||(d(e)?"ALPHA_NUM":void 0),n=n||(s(e)?"8bit":""),c(n,e)?n:""},u=n.find("canvas")[0],g=!!e.CanvasRenderingContext2D;t.TYPE_NUMBER=function(){return t.typeNumber||0}(),t.TEXT=r(),t.CORRECTION=function(){var e=t.correctionLevel||0;return{L:1,M:0,Q:3,H:2}[e]||0}(),t.SIZE=function(){return t.size||$(n).outerWidth()}(),t.INPUT_MODE=p(t.TEXT),t.canvasImage="";var m=function(e,t,n,a){for(var o=Math.round,r=Math.ceil,l=0;l<n;l++)for(var d=0;d<n;d++){var s=r((d+1)*a)-_Mathfloor(d*a),c=r((l+1)*a)-_Mathfloor(l*a);e.fillStyle=t.isDark(l,d)?"#000":"#fff",e.fillRect(o(d*a),o(l*a),s,c)}},f=function(e,n,a,o,r,l){var d=/^\s+|\s+$/g,s=n.replace(d,""),c=new QRCode(a,o,l);c.addData(s),c.make();var p=e.getContext("2d"),u=c.getModuleCount();e.width=e.height=r,g&&(m(p,c,u,r/u),t.canvasImage=e.toDataURL()||"")};t.$watch(function(){return o.$modelValue},function(e,n){(e!==n||e!==t.TEXT)&&(t.text=o.$modelValue,t.TEXT=r(),t.INPUT_MODE=p(t.TEXT),f(u,t.TEXT,t.TYPE_NUMBER,t.CORRECTION,t.SIZE,t.INPUT_MODE))}),f(u,t.TEXT,t.TYPE_NUMBER,t.CORRECTION,t.SIZE,t.INPUT_MODE)}}}]).directive("uiSelect",["$compile",function(e){return{restrict:"E",require:"ngModel",link:function(t,n,a){if(a.required!=null||"true"===a.ngRequired){$(n).append("<input autocomplete=\"off\" tabindex=\"-1\" class=\"uiSelectRequired ui-select-offscreen\" style=\"left: 50%!important; top: 100%!important;\" type=text ng-model=\""+a.ngModel+"\" required>");var o=$(n).find("input.uiSelectRequired");e(o)(n.scope())}}}}]).filter("raw",["$translate",function(){return function(e){return null!=e&&void 0!==e?"number"==typeof e?e+"":"boolean"==typeof e?e+"":e instanceof Date?"datetimeoffset'"+e.toISOString()+"'":10<=e.length&&e.match(ISO_PATTERN)?"datetimeoffset'"+e+"'":"'"+e+"'":""}}]).filter("js",["$translate",function(){return function(e){return null!=e&&void 0!==e?"number"==typeof e||"boolean"==typeof e?e+"":e instanceof Date?cronapi.toDate(e.toISOString()):10<=e.length&&e.match(ISO_PATTERN)?cronapi.toDate(e):"'"+e+"'":"undefined"}}]).filter("mask",["$translate",function(e){return function(t,n){if(n=parseMaskType(n,e),!n)return t;if(n=n.replace(";1","").replace(";0","").trim(),"string"==typeof t&&t.match(isoDate))return moment.utc(t).format(n);if(t instanceof Date)return moment.utc(t).format(n);if("number"==typeof t)return format(n,t);if(null!=t&&null!=t&&""!=t){var a=$("<input type=\"text\">");return a.mask(n),a.masked(t)}return t}}]).directive("screenParams",[function(){'use strict';return{link:function(scope,elem,attrs,ctrl){var screenParams=eval(attrs.screenParams);screenParams&&screenParams.length&&screenParams.forEach(function(e){scope.params&&!scope.params[e.key]&&(scope.params[e.key]=e.value||"")})}}}]).directive("mask",maskDirectiveMask).directive("cronappFilter",["$compile",function($compile){return{restrict:"A",require:"?ngModel",setFilterInButton:function(e,t){var n=e.closest("fieldset");if(n){var a=n.find("button[cronapp-filter]");if(a){var o=a.data("filters");o||(o=[]);var r=-1,l=e.attr("ng-model");if($(o).each(function(e){this.ngModel==l&&(r=e)}),-1<r&&o.splice(r,1),0<t.length){o.push({ngModel:l,bindedFilter:t})}a.data("filters",o)}}},makeAutoPostSearch:function(e,t,n,a){var o=e.closest("fieldset");if(o&&0<o.length){var r=o.find("button[cronapp-filter]");if(r&&0<r.length){var l=r.data("filters");l&&0<l.length&&(t="",$(l).each(function(){t+=this.bindedFilter+";"}))}}n.search(t,"true"==a.cronappFilterCaseinsensitive)},inputBehavior:function(scope,element,attrs,ngModelCtrl,$element,typeElement,operator,autopost){var datasource,filterTemplate="",filtersSplited=attrs.cronappFilter.split(";");if(attrs.crnDatasource)datasource=eval(attrs.crnDatasource);else{var fieldset=$element.closest("fieldset");if(!fieldset)return;var button=fieldset.find("button[cronapp-filter]");if(!button)return;if(!button.attr("crn-datasource"))return;datasource=eval(button.attr("crn-datasource"))}var isOData=datasource.isOData();$(filtersSplited).each(function(){0<this.length&&(""!=filterTemplate&&(isOData?filterTemplate+=" or ":filterTemplate+=";"),isOData?"="==operator&&"text"==typeElement?filterTemplate+="substringof({value.lower}, tolower("+this+"))":"="==operator?filterTemplate+=this+" eq {value}":"!="==operator?filterTemplate+=this+" ne {value}":">"==operator?filterTemplate+=this+" gt {value}":">="==operator?filterTemplate+=this+" ge {value}":"<"==operator?filterTemplate+=this+" lt {value}":"<="==operator&&(filterTemplate+=this+" le {value}"):"text"==typeElement?filterTemplate+=this+"@"+operator+"%{value}%":filterTemplate+=this+operator+"{value}")}),0==filterTemplate.length&&(isOData?filterTemplate="{value}":filterTemplate="%{value}%");var selfDirective=this;ngModelCtrl?scope.$watch(attrs.ngModel,function(e,t){if(!angular.equals(e,t)){var n=$element.data("type")||$element.attr("type"),a=ngModelCtrl.$modelValue;isOData?a instanceof Date?"datetime-local"==n?a="datetimeoffset'"+a.toISOString()+"'":a="datetime'"+a.toISOString().substring(0,23)+"'":"number"==typeof a?a+="M":"boolean"==typeof a?a=a:a="'"+a+"'":a instanceof Date?(a=a.toISOString(),a+="date"==n?"@@date":"time"==n||"time-local"==n?"@@time":"@@datetime"):"number"==typeof a?a+="@@number":"boolean"==typeof a&&(a+="@@boolean");var o=filterTemplate.split("{value}").join(a);if("string"!=typeof a)o=o.split("{value.lower}").join(a);else if(o.startsWith("substringof({")){var r=a.split("'").join("").toLowerCase().trim().split(" "),l="";r.forEach(function(e,t){l+=o.split("{value.lower}").join("'"+e+"'"),t<r.length-1&&(l+=" or ")}),o=l}else o=o.split("{value.lower}").join(a.toLowerCase());0==ngModelCtrl.$viewValue.length&&(o=""),selfDirective.setFilterInButton($element,o,operator),autopost&&selfDirective.makeAutoPostSearch($element,o,datasource,attrs)}}):"text"==typeElement?$element.on("keyup",function(){var datasource=eval(attrs.crnDatasource),value=void 0;value=ngModelCtrl&&null!=ngModelCtrl?ngModelCtrl.$viewValue:this.value;var bindedFilter=filterTemplate.split("{value}").join(value);0==this.value.length&&(bindedFilter=""),selfDirective.setFilterInButton($element,bindedFilter,operator),autopost&&selfDirective.makeAutoPostSearch($element,bindedFilter,datasource,attrs)}):$element.on("change",function(){var datasource=eval(attrs.crnDatasource),value=void 0,typeElement=$(this).attr("type");if(null!=attrs.asDate&&(typeElement="date"),ngModelCtrl&&null!=ngModelCtrl)value=ngModelCtrl.$viewValue;else if("checkbox"==typeElement)value=$(this).is(":checked");else if("date"!=typeElement)value=this.value;else if(value=this.value,0<this.value.length){var momentDate=moment(this.value,patternFormat(this));value=momentDate.toDate().toISOString()}var bindedFilter=filterTemplate.split("{value}").join(value);0==value.toString().length&&(bindedFilter=""),selfDirective.setFilterInButton($element,bindedFilter,operator),autopost&&selfDirective.makeAutoPostSearch($element,bindedFilter,datasource,attrs)})},forceDisableDatasource:function(datasourceName,scope){var disableDatasource=setInterval(function(){try{var datasourceInstance=eval(datasourceName);datasourceInstance&&($(document).ready(function(){var e=0,t=setInterval(function(){10>e?(scope.$apply(function(){datasourceInstance.enabled=!1,datasourceInstance.data=[]}),e++):clearInterval(t)},20)}),clearInterval(disableDatasource))}catch(t){}},10)},buttonBehavior:function(scope,element,attrs,ngModelCtrl,$element,typeElement,operator,autopost){var datasourceName="";datasourceName=attrs.crnDatasource?attrs.crnDatasource:$element.parent().attr("crn-datasource");var datasource=eval(datasourceName),isOData=datasource.isOData(),requiredFilter=attrs.requiredFilter&&"true"==attrs.requiredFilter.toString();requiredFilter&&this.forceDisableDatasource(datasourceName,scope),$element.on("click",function(){var $this=$(this),filters=$this.data("filters");if(datasourceName&&0<datasourceName.length&&filters){var bindedFilter="";$(filters).each(function(){""!=bindedFilter&&(bindedFilter+=isOData?" and ":";"),bindedFilter+=this.bindedFilter});var datasourceToFilter=eval(datasourceName);requiredFilter?(datasourceToFilter.enabled=0<bindedFilter.length,datasourceToFilter.enabled?datasourceToFilter.search(bindedFilter,"true"==attrs.cronappFilterCaseinsensitive):scope.$apply(function(){datasourceToFilter.data=[]})):datasourceToFilter.search(bindedFilter,"true"==attrs.cronappFilterCaseinsensitive)}})},link:function(e,t,n,a){var o=$(t),r=o.data("type")||o.attr("type");n.asDate!=null&&(r="date");var l="=";n.cronappFilterOperator&&0<n.cronappFilterOperator.length&&(l=n.cronappFilterOperator);var d=!0;n.cronappFilterAutopost&&"false"==n.cronappFilterAutopost&&(d=!1),setTimeout(function(){"INPUT"==o[0].tagName?this.inputBehavior(e,t,n,a,o,r,l,d):this.buttonBehavior(e,t,n,a,o,r,l,d)}.bind(this),100)}}}]).directive("cronRichEditor",["$compile",function(e){return{restrict:"E",replace:!0,require:"ngModel",parseToTinyMCEOptions:function(e){var t={allowFullScreen:"fullscreen |",allowPage:"fullpage newdocument code pagebreak |",allowPrint:"preview print |",allowTransferArea:"cut copy paste |",allowDoUndo:"undo redo |",allowSymbol:"charmap |",allowEmbeddedImage:"bdesk_photo |",allowFont:"formatselect fontselect fontsizeselect strikethrough bold italic underline removeformat |",allowLinks:"link unlink anchor |",allowParagraph:"alignleft aligncenter alignright alignjustify numlist bullist outdent indent blockquote hr |",allowFormulas:"tiny_mce_wiris_formulaEditor tiny_mce_wiris_formulaEditorChemistry tiny_mce_wiris_CAS |"},n={menubar:!1,statusbar:!1,plugins:"bdesk_photo advlist anchor autolink autoresize autosave charmap code colorpicker contextmenu directionality emoticons fullpage fullscreen hr image imagetools importcss insertdatetime legacyoutput link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace tabfocus table template toc visualblocks visualchars wordcount tiny_mce_wiris",toolbar:"",content_style:""};for(var a in e)a.startsWith("allow")&&e[a]&&(n.toolbar+=" "+t[a]);return n.menubar=e.showMenuBar,n.statusbar=e.showStatusBar,n.content_style=e.contentStyle,JSON.stringify(n)},link:function(t,n,a){var o=JSON.parse(a.options),r=this.parseToTinyMCEOptions(o),l="                  <textarea                     ui-tinymce=\"$options$\"                     ng-model=\"$ngModel$\"                     id=\"$id$\"                     ng-cron-click=\"$ngClick$\"                     ng-cron-dblclick=\"$ngDblclick$\"                     ng-cron-mousedown=\"$ngMouseDown$\"                     ng-cron-mouseup=\"$ngMouseUp$\"                     ng-cron-mousemove=\"$ngMouseMove$\"                     ng-cron-mouseover=\"$ngMouseOver$\"                     ng-cron-mouseenter=\"$ngMouseEnter$\"                     ng-cron-mouseleave=\"$ngMouseLeave$\"                     ng-cron-keydown=\"$ngKeydown$\"                     ng-cron-keyup=\"$ngKeyup$\"                     ng-cron-keypress=\"$ngKeypress$\"                    ng-context-menu=\"$ngContextMenu$\"                     ng-cron-paste=\"$ngPaste$\"                     ng-cron-init=\"$ngInit$\"                     ng-cron-focus=\"$ngFocus$\"                     ng-cron-blur=\"$ngBlur$\"                     ng-before-set-content=\"$ngBeforeSetContent$\"                     ng-set-content=\"$ngSetContent$\"                     ng-get-content=\"$ngGetContent$\"                     ng-pre-process=\"$ngPreProcess$\"                     ng-post-process\"$ngPostProcess$\"                     ng-node-change=\"$ngNodeChange$\"                     ng-cron-undo=\"$ngUndo$\"                     ng-cron-redo=\"$ngRedo$\"                     ng-cron-change=\"$ngChange$\"                     ng-cron-dirty=\"$ngDirty$\"                     ng-cron-remove=\"$ngRemove$\"                     ng-exec-command=\"$ngExecCommand$\"                     ng-paste-pre-process=\"$ngPastePreProcess$\"                     ng-paste-post-process=\"$ngPastePostProcess$\"                     ng-add-editor=\"$ngAddEditor$\"                     ng-remove-editor=\"$ngRemoveEditor$\">                   </textarea>                 ";l=$(l.split("$ngModel$").join(a.ngModel).split("$ngClick$").join(a.ngCronClick||"").split("$ngDblclick$").join(a.ngCronDblclick||"").split("$ngMouseDown$").join(a.ngCronMouseDown||"").split("$ngMouseUp$").join(a.ngCronMouseUp||"").split("$ngMouseMove$").join(a.ngCronMouseMove||"").split("$ngMouseOver$").join(a.ngCronMouseOver||"").split("$ngMouseEnter$").join(a.ngCronMouseEnter||"").split("$ngMouseLeave$").join(a.ngCronMouseLeave||"").split("$ngKeydown$").join(a.ngCronKeydown||"").split("$ngKeyup$").join(a.ngCronKeyup||"").split("$ngKeypress$").join(a.ngCronKeypress||"").split("$ngContextMenu$").join(a.ngContextMenu||"").split("$ngPaste$").join(a.ngCronPaste||"").split("$ngInit$").join(a.ngCronInit||"").split("$ngFocus$").join(a.ngCronFocus||"").split("$ngBlur$").join(a.ngCronBlur||"").split("$ngBeforeSetContent$").join(a.ngBeforeSetContent||"").split("$ngSetContent$").join(a.ngSetContent||"").split("$ngGetContent$").join(a.ngGetContent||"").split("$ngPreProcess$").join(a.ngPreProcess||"").split("$ngPostProcess$").join(a.ngPostProcess||"").split("$ngNodeChange$").join(a.ngNodeChange||"").split("$ngUndo$").join(a.ngCronUndo||"").split("$ngRedo$").join(a.ngCronRedo||"").split("$ngChange$").join(a.ngCronChange||"").split("$ngDirty$").join(a.ngCronDirty||"").split("$ngRemove$").join(a.ngRemove||"").split("$ngExecCommand$").join(a.ngExecCommand||"").split("$ngPastePreProcess$").join(a.ngPastePreProcess||"").split("$ngPastePostProcess$").join(a.ngPastePostProcess||"").split("$ngAddEditor$").join(a.ngAddEditor||"").split("$ngRemoveEditor$").join(a.ngRemoveEditor||"").split("$id$").join(a.id||app.common.generateId()).split("$options$").join(escape(r)));var d=angular.element(l);n.html(""),n.append(d),n.attr("id",null),e(d)(t)}}}]).directive("cronReportViewer",["$compile",function(){return{restrict:"E",replace:!0,require:"ngModel",link:function(e,t,n){function a(n){var a=JSON.parse(n);e.$eval(a.reportCommand,{element:t})}a(n.options);var o=null;e.$watch(function(){return n.options},function(e,t){e!==t&&(o&&(clearInterval(o),o=null),o=setTimeout(function(){a(e)}.bind(this),500))})}}}]).directive("cronGrid",["$compile","$translate",function($compile,$translate){return{restrict:"E",replace:!0,require:"ngModel",initCulture:function(){var e=$translate.use();e=e.replace(/_/gm,"-");var t=e.split("-");t[t.length-1]=t[t.length-1].toUpperCase(),e=t.join("-"),kendo.culture(e)},generateBlocklyCall:function(e){var t;if("client"==e.type){t="cronapi.client('"+e.blocklyClass+"."+e.blocklyMethod+"')";var n="";e.blocklyParams.forEach(function(e){0<n.length&&(n+=", "),n+=e.value?e.value:"null"}),t+=".run("+n+")"}else if("server"==e.type){var a=e.blocklyClass+"."+e.blocklyMethod;t="cronapi.server('"+a+"')";var n="";e.blocklyParams.forEach(function(e){0<n.length&&(n+=", "),n+=e.value?e.value:"null"}),t+=".run("+n+")"}return t},generateToolbarButtonCall:function(toolbarButton,scope,options){var buttonCall,generateObjTemplate=function(e,t,n){var a={template:function(){var a=app.common.generateId();return createTemplateButton(a,e,t,n)}.bind(this)};return a}.bind(this),createTemplateButton=function(buttonId,functionToCall,title,iconClass){var template="";"SaveOrCancelChanges"==toolbarButton.type?toolbarButton.saveButton?template="<a role=\"button\" class=\"saveorcancelchanges k-button k-button-icontext k-grid-save-changes\" id=\"#BUTTONID#\" href=\"javascript:void(0)\"><span class=\"k-icon k-i-check\"></span>#TITLE#</a>":template="<a role=\"button\" class=\"saveorcancelchanges k-button k-button-icontext k-grid-cancel-changes\" id=\"#BUTTONID#\" href=\"javascript:void(0)\"><span class=\"k-icon k-i-cancel\" ></span>#TITLE#</a>":"Blockly"==toolbarButton.type||"Customized"==toolbarButton.type?template="<a class=\"k-button k-grid-custom\" id=\"#BUTTONID#\" href=\"javascript:void(0)\"><span class=\"#ICONCLASS#\" ></span>#TITLE#</a>":"Native"==toolbarButton.type&&"create"==toolbarButton.title&&(template="<a role=\"button\" id=\"#BUTTONID#\" class=\"k-button k-button-icontext k-grid-add\" href=\"javascript:void(0)\"><span class=\"k-icon k-i-plus\"></span>{{\"Add\" | translate}}</a>"),template=template.split("#BUTTONID#").join(buttonId).split("#FUNCTIONCALL#").join(this.encodeHTML(functionToCall)).split("#TITLE#").join(title).split("#ICONCLASS#").join(iconClass);var cronappDatasource=eval(options.dataSourceScreen.entityDataSource.name),waitRender=setInterval(function(){0<$("#"+buttonId).length&&(scope.safeApply(function(){var e=angular.element($("#"+buttonId));$compile(e)(scope)}),$("#"+buttonId).click(function(){var e=options.grid,t=[];e.select().each(function(){var n=e.dataItem(this);cronappDatasource.data.forEach(function(e){e.__$id==n.__$id&&t.push(e)})});var n={item:cronappDatasource.active,index:cronappDatasource.cursor},a={currentData:cronappDatasource.data,datasource:cronappDatasource,selectedIndex:cronappDatasource.cursor,index:cronappDatasource.cursor,selectedRow:cronappDatasource.active,consolidated:n,item:cronappDatasource.active,selectedKeys:cronappDatasource.getKeyValues(cronappDatasource.active,!0),selectedRows:t};scope.$eval(functionToCall,a)}.bind(this)),clearInterval(waitRender))}.bind(this),200);return template}.bind(this),call="";call="Customized"==toolbarButton.type?toolbarButton.execute:toolbarButton.methodCall?toolbarButton.methodCall:this.generateBlocklyCall(toolbarButton.blocklyInfo);var title=null==toolbarButton.title?"":toolbarButton.title;return buttonCall=generateObjTemplate(call,title,toolbarButton.iconClass),buttonCall},generateModalSaveOrCancelButtonCall:function(e,t,n,a,o){var r=app.common.generateId();return buttonCall=function(e,t,n,a){var l;l="save"==e?"<button id=\"#BUTTONID#\" class=\"btn btn-primary btn-fab ng-binding grid-save-button-modal k-button\" data-component=\"crn-button\" ng-click=\"#FUNCTIONCALL#\" onclick=\"(!#DATASOURCENAME#.missingRequiredField()?$('##MODALID#').modal('hide'):void(0))\"><span class=\"k-icon k-i-check\"></span></button>":"<button id=\"#BUTTONID#\" type=\"button\" class=\"btn btn-default btn-fab ng-binding k-button\" data-component=\"crn-button\" data-dismiss=\"modal\"><span class=\"k-icon k-i-cancel\"></span></button>",l=l.split("#BUTTONID#").join(r).split("#FUNCTIONCALL#").join(t).split("#DATASOURCENAME#").join(n).split("#MODALID#").join(a);var d=setInterval(function(){0<$("#"+r).length&&o.safeApply(function(){var e=angular.element($("#"+r));$compile(e)(o),clearInterval(d)})},200);return l}(e,t,n,a),buttonCall},addButtonsInModal:function(e,t,n){var a=$("#"+e).find(".modal-footer");if(!a.find(".grid-save-button-modal").length){var o=this.generateModalSaveOrCancelButtonCall("save",t+".post();",t,e,n);a.append(o);var r=this.generateModalSaveOrCancelButtonCall("cancel",null,null,null,n);a.append(r)}},getObjectId:function(e){if(!e)e="";else if(e instanceof Date){var t=moment.utc(e);e=new Date(t.format("YYYY-MM-DDTHH:mm:ss"))}else if("object"==typeof e)if(e.id)e=e.id;else for(var n in e){e=e[n];break}return e},encodeHTML:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},decodeHTML:function(e){return e.replace(/&apos;/g,"'").replace(/&quot;/g,"\"").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")},getColumns:function(t,n,a,o){function r(e){var t="#=showTreatedValue("+e.field+")#";return"switch"==e.inputType?t="<span class=\"k-switch km-switch k-widget km-widget k-switch-off km-switch-off\" style=\"width: 100%\">                  <span class=\"k-switch-wrapper km-switch-wrapper\">                    <span class=\"k-switch-background km-switch-background\" style=\"margin-left: #="+e.field+" ? \"80%\": \"0%\" #\"></span>                  </span>                  <span class=\"k-switch-container km-switch-container\">                    <span class=\"k-switch-handle km-switch-handle\" style=#="+e.field+" ? \"float:right;margin-right:-1px\": \"margin-left:0%\" #>                    </span>                  </span>                </span>":"checkbox"==e.inputType||"boolean"==e.type?t="<input type='checkbox' class='k-checkbox' #="+e.field+" ? \"checked='checked'\": '' # /><label class='k-checkbox-label k-no-text'></label>":e.displayField&&0<e.displayField.length?l(e.type)||e.format&&"null"!=e.format?t="#= useMask("+e.displayField+",'"+e.format+"','"+e.type+"') #":t="#="+e.displayField+"#":(l(e.type)||e.format&&"null"!=e.format)&&(t="#= useMask("+e.field+",'"+e.format+"','"+e.type+"') #"),t}function l(e){return!!(e&&"string"==typeof e)&&(e.startsWith("date")||e.startsWith("month")||e.startsWith("time")||e.startsWith("week")||e.startsWith("money")||e.startsWith("number")||e.startsWith("tel")||e.startsWith("integer"))}function d(e){return l(e.type)?void 0:e.format}function s(e){var n=null;return t.columns.forEach(function(t){t.field==e&&(n=t)}),n}function c(e){var t=!1,a=null;return n.schema.model.fields[e]&&(a=n.schema.model.fields[e]),a&&(t=!a.nullable),t}function p(){return u.bind(this)}function u(e,t){var n=s(t.field);null==n.visibleCrud||n.visibleCrud||(e.parent().find(".k-edit-label [for="+n.field+"]").parent().remove(),e.remove());var o=c(t.field)?"required":"",r=app.common.generateId(),l=$("<input "+o+" name=\""+t.field+"\" id=\""+r+"\"from-grid=true />");if("dynamicComboBox"==n.inputType||"comboBox"==n.inputType){var d=app.kendoHelper.getConfigCombobox(n.comboboxOptions,a);d.autoBind=!0,d.optionLabel=void 0,n.displayField&&(d.change=function(){t.model.set(n.displayField,this.text()),t.model.dirty=!0,t.model.dirtyFields[n.displayField]=!0}),l.appendTo(e).kendoDropDownList(d,a)}else if("slider"==n.inputType){var d=app.kendoHelper.getConfigSlider(n.sliderOptions);l.appendTo(e).kendoSlider(d,a)}else if("switch"==n.inputType){var d=app.kendoHelper.getConfigSwitch(n.switchOptions);l.appendTo(e).kendoMobileSwitch(d,a)}else if("checkbox"==n.inputType||"boolean"==n.type){var p=app.common.generateId();l=$("<input id=\""+p+"\" name=\""+t.field+"\" class=\"k-checkbox\" type=\"checkbox\" ><label class=\"k-checkbox-label\" for=\""+p+"\"></label>"),l.appendTo(e)}else if("date"==n.inputType){l.attr("cron-date",""),l.attr("options",JSON.stringify(n.dateOptions)),l.data("initial-date",t.model[t.field]),l.appendTo(e).off("change");var u=setInterval(function(){if(0<$("#"+r).length){var e=angular.element($("#"+r));$compile(e)(a),clearInterval(u),$("#"+r).on("change",function(){setTimeout(function(){t.model[t.field]=$("#"+r).data("rawvalue"),t.model.dirty=!0,t.model.dirtyFields[t.field]=!0}.bind(this))})}},10)}else{l.attr("type",n.type),l.attr("mask",n.format?n.format:""),l.attr("class","k-input k-textbox"),l.data("initial-value",t.model[t.field]),l.appendTo(e);var u=setInterval(function(){if(0<$("#"+r).length){$("#"+r).off("change"),$("#"+r).on("change",function(){t.model[t.field]=$("#"+r).data("rawvalue"),t.model.dirty=!0,t.model.dirtyFields[t.field]=!0});var e=angular.element($("#"+r));$compile(e)(a),clearInterval(u)}},10)}}function g(e,n){var o;return o="popupCustom"==e.editable||"datasource"==e.editable?{name:app.common.generateId(),text:"",iconClass:"k-icon k-i-edit",className:"k-grid-edit",click:function(n){n.preventDefault();var o=$(n.target).closest("tr"),r=o.closest("table"),l=this.dataItem(o),d=this.dataSource.transport.options.cronappDatasource;a.safeApply(function(){t.hideModalButtons||y.addButtonsInModal(t.popupEdit,d.name,a);var n=d.goTo(l);d.startEditing(n,function(){}),"datasource"!=e.editable&&cronapi.screen.showModal(t.popupEdit)})}}:{name:n,text:{edit:" ",update:" ",cancel:" "}},o}function m(e,t){var n;return n="popupCustom"==e.editable||"datasource"==e.editable?{name:app.common.generateId(),text:"",iconClass:"k-icon k-i-close",className:"k-grid-delete",click:function(t){t.preventDefault();var e=$(t.target).closest("tr"),n=this.dataItem(e),o=this.dataSource.transport.options.cronappDatasource,r=this;a.safeApply(function(){var e,t=o.goTo(n);o.active.__status&&"inserted"==o.active.__status&&(e=function(){r.dataSource.remove(n)}),o.remove(t,e)})}}:{name:t,text:" "},n}function f(e){if(e&&e.aggregates){var t=[];if(e.aggregates.forEach(function(e){t.push(e.type)}),0<t.length)return t}}function h(e,t){if(e&&e.aggregates){var n=[];return e.aggregates.forEach(function(o){var a="#=data."+e.field+" ? data."+e.field+"."+o.type+" : 0 #";("average"==o.type||"sum"==o.type)&&(a="#=useMask(data."+e.field+" ? data."+e.field+"."+o.type+" : 0,'"+e.format+"','"+e.type+"')#");var r=t?o.groupFooterTemplate:o.footerTemplate;r?r+=": ":r="";var l=r+a;e.alignment&&("right"!==e.alignment||t?l="<div style=\"text-align: "+e.alignment+"\">"+l+"</div>":l="<div style=\"text-align: "+e.alignment+"\" class=\"k-fix-margin\">"+l+"</div>"),n.push(l)}),n.join("<br/>")}}function b(e){return l(e.type)||e.format&&"null"!=e.format?e.headerText+": #=useMask(value,'"+e.format+"','"+e.type+"')#":void 0}function v(e){if(e&&e.alignment){var t={style:"text-align: "+e.alignment+";"};return t}}var y=this,k=[];return t.columns&&t.columns.forEach(function(n){if("Database"==n.dataType){var l={field:n.field,title:n.headerText,type:n.type,width:n.width,sortable:n.sortable,filterable:n.filterable,hidden:!n.visible};l.template=r(n),l.format=d(n),l.editor=p.bind(this)(n),l.aggregates=f(n),l.footerTemplate=h(n,!1),l.groupFooterTemplate=h(n,!0),l.groupHeaderTemplate=b(n),l.attributes=v(n),l.headerAttributes=l.attributes,k.push(l)}else if("Command"==n.dataType){if("no"!=t.editable){var s=n.command.split("|"),c=[];s.forEach(function(e){var n;n="edit"==e?g.bind(this)(t,e):m.bind(this)(t,e),c.push(n)}.bind(this));var l={command:c,title:n.headerText,width:n.width?n.width:155,hidden:!n.visible};k.push(l)}}else if("Blockly"==n.dataType||"Customized"==n.dataType||"CustomizedLink"==n.dataType){var u=null==n.label?"":n.label;n.iconClass&&u&&(u="&nbsp;"+u);var S="";S="CustomizedLink"==n.dataType?"k-custom-link":"k-custom-command"+(u?" k-button-with-label":""),n.theme&&(S+=" "+n.theme);var C="";if(n.tooltip&&n.tooltip.length?C=n.tooltip:n.label&&n.label.length&&(C=n.label),C){var w=app.common.generateId();o[w]=C,S+=" "+w}var l={command:[{name:app.common.generateId(),text:u,hidden:!n.visible,className:S,iconClass:n.iconClass,click:function(o){o.preventDefault();var e=$(o.target).closest("tr"),r=e.closest("table"),l=this.dataItem(e),d=$(r.find("tbody")[0]).children().index(e),s=void 0;s="Customized"==n.dataType||"CustomizedLink"==n.dataType?n.execute:y.generateBlocklyCall(n.blocklyInfo);var c=this.dataSource.transport.options.cronappDatasource,p=t.grid,u=[];if(p.select().each(function(){var e=p.dataItem(this);c.data.forEach(function(t){t.__$id==e.__$id&&u.push(t)})}),!(c.inserting||c.editing)){var e=o.currentTarget.parentElement.parentElement;this.select(e)}var g={currentData:c.data,datasource:c,selectedIndex:d,index:d,selectedRow:l,consolidated:{item:l,index:d},item:l,selectedKeys:c.getKeyValues(c.active,!0),selectedRows:u};a.$eval(s,g)}}],width:n.width,title:n.headerText?n.headerText:"",hidden:!n.visible};k.push(l)}else if("Selectable"==n.dataType){k.push({selectable:!0})}}.bind(this)),k},getPageAble:function(e){var t={refresh:e.allowRefreshGrid,pageSizes:e.allowSelectionTotalPageToShow,buttonCount:5};return e.allowPaging||(t=e.allowPaging),t},getToolbar:function(e,t){var n=[];return e.toolBarButtons.forEach(function(a){if("Native"==a.type){if("no"==e.editable)("pdf"==a.title||"excel"==a.title)&&n.push(a.title);else if(("datasource"==e.editable||"popupCustom"==e.editable)&&"create"==a.title){var o=e.dataSourceScreen.name,r=e.popupInsert;a.methodCall=o+".startInserting();","popupCustom"==e.editable&&(a.methodCall=a.methodCall+" cronapi.screen.showModal('"+r+"');");var l=this.generateToolbarButtonCall(a,t,e);n.push(l),e.hideModalButtons||this.addButtonsInModal(r,o,t)}else n.push(a.title);}else if("Blockly"==a.type||"Customized"==a.type){var d=this.generateToolbarButtonCall(a,t,e);n.push(d)}else if("SaveOrCancelChanges"==a.type){if("no"!=e.editable){var s=this.generateToolbarButtonCall(a,t,e);n.push(s)}}else if("Template"==a.type||"Title"==a.type){var c={template:a.template};n.push(c)}}.bind(this)),0==n.length&&(n=void 0),n},getEditable:function(e){var t={mode:e.editable,confirmation:!1};return"batch"==e.editable?t=!0:("no"==e.editable||"popupCustom"==e.editable||"datasource"==e.editable)&&(t=!1),t},getTooltipsDefault:function(){var e={k_grid_edit:$translate.instant("Edit"),k_grid_delete:$translate.instant("Remove"),k_grid_update:$translate.instant("Save"),k_grid_cancel:$translate.instant("Cancel")};return e},setTooltips:function(e,t){for(var n in t){var a="."+n.replace(/_/g,"-");e.kendoTooltip({filter:a,content:function(n){var e=n.sender.options.filter.substr(1).replace(/-/g,"_");return t[e]}})}},generateKendoGridInit:function(e,t,n,a,o){var r=this,l=function(e,t,n){var a=e.table.find(".k-master-row");a.each(function(){(null==n||this!=n[0])&&e.collapseRow(this)});var o=e.table.find(".k-detail-row");o.each(function(){(null==t||this!=t[0])&&$(this).remove()})},d=function(e,t,n){var a=e.table.find(".k-master-row");a.each(function(){(null!=n||this==n[0])&&e.collapseRow(this)});var o=e.table.find(".k-detail-row");o.each(function(){(null!=t||this==t[0])&&$(this).remove()})},s=function(e){var n=this.dataSource.transport.options.cronappDatasource;n.inserting||n.editing||t.safeApply(n.goTo(e))},c=function(n){if(n.sender.tbody&&n.sender.tbody.length){var e=n.sender.tbody;e.parent()&&e.parent().parent()&&e.parent().parent().parent()&&(e=e.parent().parent().parent()),t.safeApply(function(){var n=$(e),a=angular.element(n);$compile(a)(t)})}},p=function(t){var n,a=0;return e.columns.forEach(function(e){"Database"==e.dataType&&(a==t&&e.visible&&(n=e),e.visible&&a++)}),n},u=app.kendoHelper.getDataSource(e.dataSourceScreen.entityDataSource,t,e.allowPaging,e.pageCount,e.columns,e.groupings),g=this.getColumns(e,u,t,o),m=this.getPageAble(e),f=this.getToolbar(e,t),h=this.getEditable(e),b=function(e){var t=!1;if(e.columns)for(var n=0;n<e.columns.length;n++)if("Database"==e.columns[n].dataType&&e.columns[n].filterable){t=!0;break}return t}(e),v={toolbar:f,pdf:{allPages:!0,avoidLinks:!0,paperSize:"A4",margin:{top:"2cm",left:"1cm",right:"1cm",bottom:"1cm"},landscape:!0,repeatHeaders:!0,scale:.8},dataSource:u,editable:h,height:e.height,groupable:e.allowGrouping,sortable:e.allowSorting,filterable:!0,pageable:m,columns:g,selectable:e.allowSelectionRow,detailInit:e.details&&0<e.details.length?function(n){if(n.masterRow.find("a").hasClass("k-i-expand"))return void d(this,n.detailRow,n.masterRow);var e=this.dataSource.transport.options.cronappDatasource;e.inserting||e.editing?l(this,null,null):(this.selectable?this.select(n.masterRow):(s.bind(this)(n.data),l(this,n.detailRow,n.masterRow)),n.sender.options.listCurrentOptions.forEach(function(e){var a=r.generateKendoGridInit(e,t,void 0,void 0,o),l=$("<div/>"),d=l.appendTo(n.detailCell).kendoGrid(a).data("kendoGrid");d.dataSource.transport.options.grid=d,e.grid=d,r.setTooltips(l,o)}))}:void 0,listCurrentOptions:e.details&&0<e.details.length?e.details:void 0,excelExport:function(t){for(var e,n=t.workbook.sheets[0],a=1;a<n.rows.length;a++){e=n.rows[a];for(var o,r=0;r<e.cells.length;r++)if(o=p(r),o&&e.cells[r].value instanceof Date){var l=new Date(e.cells[r].value.getTime());l.setMinutes(l.getMinutes()+l.getTimezoneOffset()),l.setSeconds(l.getSeconds()+4),e.cells[r].value=l,"time"==o.type?e.cells[r].format="[$-x-systime]hh:mm:ss":"datetime"==o.type&&(e.cells[r].format="dd/mm/yyyy hh:mm:ss;@")}}},edit:function(n){this.dataSource.transport.options.disableAndSelect(n);var e=n.container,o=this.dataSource.transport.options.cronappDatasource;if(n.model.isNew()&&!n.model.dirty){var r=n.model;o.startInserting(null,function(t){for(var n in t)if(r.fields[n]){if(r.fields[n].validation&&r.fields[n].validation.required){var a=e.find("input[name='"+n+"']");a.length&&a.val(t[n]).trigger("change")}r.set(n,t[n])}})}else n.model.isNew()||n.model.dirty||t.safeApply(function(){var e=o.goTo(n.model);o.startEditing(e,function(){})});a&&a.ngEdit&&t.$eval(a.ngEdit),c(n)},change:function(o){var e=this.dataItem(this.select());s.bind(this)(e);var r=this.dataSource.transport.options.cronappDatasource;n&&n.$setViewValue(r.active),l(this,this.select().next(),this.select()),a&&a.ngChange&&t.$eval(a.ngChange),c(o)},cancel:function(n){var e=this.dataSource.transport.options.cronappDatasource;t.safeApply(e.cancel()),this.dataSource.transport.options.enableAndSelect(n),setTimeout(function(){a&&a.ngCancel&&t.$eval(a.ngCancel),c(n)}.bind(this))},dataBound:function(n){this.dataSource.transport.options.selectActiveInGrid(),a&&a.ngDataBound&&t.$eval(a.ngDataBound),c(n)}};return v.selectable&&"multiple"==e.allowSelectionRowType&&(v.selectable="multiple"),v.originalSelectable=v.selectable,a&&a.ngBeforeEdit&&(v.beforeEdit=function(){t.$eval(a.ngBeforeEdit)}),a&&a.ngDataBinding&&(v.dataBinding=function(){t.$eval(a.ngDataBinding)}),a&&a.ngSave&&(v.save=function(){t.$eval(a.ngSave)}),a&&a.ngSaveChanges&&(v.saveChanges=function(){t.$eval(a.ngSaveChanges)}),a&&a.ngRemove&&(v.remove=function(){t.$eval(a.ngRemove)}),v},link:function(e,t,n,a){var o=$("<div></div>"),r="plugins/cronapp-lib-js/dist/js/kendo-ui/js/messages/kendo.messages.";r+="pt_br"==$translate.use()?"pt-BR.min.js":"en-US.min.js",this.initCulture();var l=this;$.getScript(r,function(){var t=JSON.parse(n.options||"{}"),r=t.batchMode==null||t.batchMode;r&&"datasource"!=t.editable&&e[t.dataSourceScreen.entityDataSource.name]&&!e[t.dataSourceScreen.entityDataSource.name].dependentLazyPost&&(e[t.dataSourceScreen.entityDataSource.name].batchPost=!0,t.toolBarButtons=t.toolBarButtons||[],t.toolBarButtons.push({type:"SaveOrCancelChanges",title:$translate.instant("SaveChanges"),methodCall:t.dataSourceScreen.entityDataSource.name+".postBatchData()",saveButton:!0}),t.toolBarButtons.push({type:"SaveOrCancelChanges",title:$translate.instant("CancelChanges"),methodCall:t.dataSourceScreen.entityDataSource.name+".cancelBatchData()",saveButton:!1}));var d=l.getTooltipsDefault(),s=l.generateKendoGridInit(t,e,a,n,d),c=o.kendoGrid(s).data("kendoGrid");c.dataSource.transport.options.grid=c,t.grid=c,l.setTooltips(o,d),e.safeApply(function(){e[t.dataSourceScreen.entityDataSource.name]&&(o.find(".k-filter-row").show(),o.find(".k-pager-sizes").show(),o.find(".k-pager-nav").show(),o.find(".k-pager-numbers").show(),o.find(".k-pager-refresh.k-link").show(),o.find(".saveorcancelchanges").hide(),e[t.dataSourceScreen.entityDataSource.name].addDataSourceEvents({pendingchanges:function(e){e?(o.find(".k-filter-row").hide(),o.find(".k-pager-sizes").hide(),o.find(".k-pager-nav").hide(),o.find(".k-pager-numbers").hide(),o.find(".k-pager-refresh.k-link").hide(),o.find(".saveorcancelchanges").show()):(o.find(".k-filter-row").show(),o.find(".k-pager-sizes").show(),o.find(".k-pager-nav").show(),o.find(".k-pager-numbers").show(),o.find(".k-pager-refresh.k-link").show(),o.find(".saveorcancelchanges").hide())}}),e[t.dataSourceScreen.entityDataSource.name].addDataSourceEvents({afterchanges:function(){}}))})}),t.html(o),$compile(o)(t.scope())}}}]).directive("cronSelect",["$compile",function(){return{restrict:"E",replace:!0,require:"ngModel",link:function(e,t,n,a){var o={};try{o=JSON.parse(n.options)}catch(e){console.log("ComboBox invalid configuration! "+e)}var r=n.id?" id=\""+n.id+"\"":"",l=n.name?" name=\""+n.name+"\"":"",d=t.parent();$(d).append("<input style=\"width: 100%;\" "+r+l+" class=\"cronSelect\" ng-model=\""+n.ngModel+"\"/>");var s=$(d).find("input.cronSelect"),c=app.kendoHelper.getConfigCombobox(o,e);c.close=n.ngClose?function(){e.$eval(n.ngClose)}:void 0,c.dataBound=n.ngDataBound?function(){e.$eval(n.ngDataBound)}:void 0,c.filtering=n.ngFiltering?function(){e.$eval(n.ngFiltering)}:void 0,c.open=n.ngOpen?function(){e.$eval(n.ngOpen)}:void 0,c.select=n.ngSelect?function(){e.$eval(n.ngSelect)}:void 0,c.change=function(){u.$apply(function(){g.$setViewValue(this.value())}.bind(p))};var p=s.kendoComboBox(c).data("kendoComboBox");$(t).remove();var u=e,g=a,m=!0;a&&(a.$formatters.push(function(t){var a="";return("boolean"==typeof t||t)&&(a=t),p.value(a),!m&&n.ngChange&&e.$eval(n.ngChange),m=!1,p.value(a),a}),a.$parsers.push(function(e){return"boolean"==typeof e||e?e:null}))}}}]).directive("cronDynamicSelect",["$compile","$timeout","$parse",function($compile,$timeout,$parse){return{restrict:"E",replace:!0,require:"?ngModel",goTo:function(e,t,n){if(dataSourceScreen=$(t).data("dataSourceScreen"),null!=dataSourceScreen)return dataSourceScreen.goTo(n,!0)},compileAngular:function(e,t){var n=$(t),a=angular.element(n);$compile(a)(e)},getActive:function(active){if(active&&active.indexOf(".active."))try{return eval(active.substr(0,active.indexOf(".active.")))}catch(t){}return null},getFieldText:function(e,t){if(e&&e.indexOf(".active.")&&t.dataTextField)try{var n=e.substr(e.indexOf(".active.")+8);return n+"_"+t.dataTextField}catch(t){}return null},isDefaultEntity:function(e){if(e&&e.entity){var t=e.entity.split("/");if(t&&0<t.length)return-1==t.pop().indexOf("query")}return!1},getModelParent:function(e){if("string"==typeof e&&9<e.length&&0<e.indexOf("|raw}}")){e=e.trim();var t=e.substr(e.indexOf("{{")+2);return t=t.substr(0,t.indexOf("|raw}}")),t.trim()}return null},link:function(scope,element,attrs,ngModelCtrl){var modelGetter=$parse(attrs.ngModel),modelSetter=modelGetter.assign,select={},self=this,parentDS={},textField=null;try{select=JSON.parse(attrs.options),parentDS=this.getActive(attrs.ngModel),textField=this.getFieldText(attrs.ngModel,select)}catch(e){console.log("DynamicComboBox invalid configuration! "+e)}var options=app.kendoHelper.getConfigCombobox(select,scope);options.autoBind=!1;var dataSourceScreen=null;try{delete options.dataSource.schema.model.id,dataSourceScreen=eval(select.dataSourceScreen.name),dataSourceScreen.rowsPerPage=dataSourceScreen.rowsPerPage?dataSourceScreen.rowsPerPage:100,options.dataSource.transport.origin="combobox"}catch(t){}options.virtual={},options.virtual.itemHeight=26;var _scope=scope,_goTo=this.goTo,_compileAngular=this.compileAngular;if(options.dataSource.pageSize&&0<options.dataSource.pageSize){options.height=options.dataSource.pageSize*options.virtual.itemHeight/4,options.virtual.mapValueTo="dataItem";var _options=options;options.virtual.valueMapper=function(e){var t=_options.combobox;if(e.value){t.isEvaluating=!0;var n=_options.dataSource.transport.options.cronappDatasource;n.findObj([e.value],!1,function(a){e.success(a),t.isEvaluating=!1,select.changeCursor?scope.safeApply(function(){if(null!=a){var e=_goTo(_scope,t,a);e||(n.data.push(a),_goTo(_scope,t,a))}else modelSetter(_scope,null)}):null==a&&modelSetter(_scope,null)},function(){e.success(null),t.isEvaluating=!1})}else e.success(null)}}options.change=attrs.ngChange?function(){scope.$eval(attrs.ngChange)}:void 0,options.close=attrs.ngClose?function(){scope.$eval(attrs.ngClose)}:void 0,options.dataBound=attrs.ngDataBound?function(){scope.$eval(attrs.ngDataBound)}:void 0,options.filtering=attrs.ngFiltering?function(){scope.$eval(attrs.ngFiltering)}:void 0,options.open=function(t){dataSourceScreen.fetched||(combobox.options.firstLazyRead=!0,combobox.dataSource.read()),attrs.ngOpen&&scope.$eval(attrs.ngOpen)(t)},options.select=attrs.ngSelect?function(){scope.$eval(attrs.ngSelect)}:void 0;var parent=element.parent(),id=attrs.id?" id=\""+attrs.id+"\"":"",name=attrs.name?" name=\""+attrs.name+"\"":"",inputSelect=$("<input style=\"width: 100%;\""+id+name+" class=\"cronDynamicSelect\" ng-model=\""+attrs.ngModel+"\"/>");attrs.$observe("required",function(e){inputSelect.prop("required",e)}),$(parent).append(inputSelect);var $element=$(parent).find("input.cronDynamicSelect"),combobox=$element.kendoDropDownList(options).data("kendoDropDownList");options.combobox=combobox,null!=dataSourceScreen&&null!=dataSourceScreen&&$(combobox).data("dataSourceScreen",dataSourceScreen),(attrs.ngRequired||attrs.required)&&($(combobox.element[0]).attr("style",""),$(combobox.element[0]).attr("class","cron-select-offscreen"));var forceChangeModel=function(e){if(combobox.value(e),select.changeCursor&&!combobox.isEvaluating)if(null==e||null==e)dataSourceScreen.active={},dataSourceScreen.cursor=-1;else{var t=_goTo(_scope,combobox,combobox.dataItem());t||(dataItem=objectClone(combobox.dataItem(),combobox.dataSource.options.schema.model.fields),dataSourceScreen.data.push(dataItem),_goTo(_scope,combobox,dataItem))}},defineInitialValue=function(){if(!combobox.isEvaluating){var e=combobox.value(),t=null,n=dataSourceScreen.goTo(e);n||((combobox.options.lazyFirstInitialValue||!dataSourceScreen.lazy)&&null!=select.initValue&&null!=select.initValue&&(combobox.options.lazyFirstInitialValue=!1,n=dataSourceScreen.goTo(select.initValue),n&&(t=select.initValue)),null==t&&select.firstValue&&dataSourceScreen&&dataSourceScreen.data.length&&(t=dataSourceScreen.data[0][select.dataValueField]),modelSetter(_scope,t),forceChangeModel(t))}},_ngModelCtrl=ngModelCtrl;null!=dataSourceScreen&&null!=dataSourceScreen&&dataSourceScreen.addDataSourceEvents({refresh:function(){defineInitialValue()},read:function(e){var t=combobox.options.fromCombo;combobox.options.fromCombo=!1,t||(combobox.options.readData=e,this.dataSource.read(),combobox.options.lazyFirstValue&&(combobox.options.lazyFirstValue=!1,defineInitialValue()))}.bind(combobox)});var _isDefaultEntity=this.isDefaultEntity;if($element.on("change",function(){_scope.$apply(function(){modelSetter(_scope,combobox.dataItem()[select.dataValueField])}),_compileAngular(scope,options.combobox.element[0])}),ngModelCtrl&&(ngModelCtrl.$formatters.push(function(e){combobox.value();return forceChangeModel(e)}),ngModelCtrl.$parsers.push(function(e){if("boolean"==typeof e||e)if(!0===combobox.options.valuePrimitive){if("string"==typeof e)return e;if("boolean"==typeof e[select.dataValueField]||e[select.dataValueField])return e[select.dataValueField]}else try{return objectClone(e,combobox.dataSource.options.schema.model.fields)}catch(t){}return null})),!select.initValue)select.initValue=null;else if(select.initValue.startsWith("params.")){var type=combobox.dataSource.options.schema.model.fields[select.dataValueField].type;select.initValue=scope.$eval(select.initValue),"string"!=type&&(select.initValue=dataSourceScreen.normalizeValue(select.initValue,!0))}else select.initValue=scope.$eval(select.initValue);""==select.initValue&&(select.initValue=null),combobox.dataSource.transport&&combobox.dataSource.transport.options&&(combobox.dataSource.transport.options.combobox=combobox,combobox.dataSource.transport.options.$compile=$compile,combobox.dataSource.transport.options.scope=scope,combobox.dataSource.transport.options.ngModelCtrl=ngModelCtrl,combobox.dataSource.transport.options.initRead=!0,null!=select.initValue&&null!=select.initValue?(modelSetter(_scope,select.initValue),combobox.options.lazyFirstInitialValue=!0):select.firstValue&&(combobox.options.lazyFirstValue=!0,dataSourceScreen.lazy&&!dataSourceScreen.fetched&&dataSourceScreen.fetch({}))),$(combobox.span).on("DOMSubtreeModified",function(t){_compileAngular(scope,t.target)}),$(combobox.ul).on("DOMSubtreeModified",function(t){$timeout(function(){_compileAngular(scope,t.target)})}),_compileAngular(scope,combobox.span),_compileAngular(scope,combobox.ul),$(element).remove()}}}]).directive("cronMultiSelect",["$compile",function($compile){return{restrict:"E",require:"ngModel",link:function(scope,element,attrs,ngModelCtrl){var _self=this,select={};try{select=JSON.parse(attrs.options)}catch(e){console.log("MultiSelect invalid configuration! "+e)}var _scope=scope,_ngModelCtrl=ngModelCtrl,relactionDS={relationDataSource:null==select.relationDataSource?null:eval(select.relationDataSource.name),relationField:null==select.relationField?"":select.relationField},options=app.kendoHelper.getConfigCombobox(select,scope);try{delete options.dataSource.schema.model.id}catch(t){}var parent=element.parent(),id=attrs.id?" id=\""+attrs.id+"\"":"",name=attrs.name?" name=\""+attrs.name+"\"":"";$(parent).append("<input style=\"width: 100%;\""+id+name+" class=\"cronMultiSelect\" ng-model=\""+attrs.ngModel+"\"/>");var $element=$(parent).find("input.cronMultiSelect");$(element).remove();var evtSelect,deselect;options.deselect=function(t){var e=t.dataItem,n=this.relationDataSource,a=t.sender.options.dataValueField,o=null;if(n&&n.data&&e[a]){for(key in n.data){var r=n.data[key];if(r[this.relationField]&&r[this.relationField]==e[a]){o=r;break}}null!=o&&($(combobox).data("silent",!0),this.relationDataSource.removeSilent(o,null,null)),deselect&&deselect()}}.bind(relactionDS),options.select=function(t){var e=t.dataItem,n=t.sender.options.dataValueField;if(this.relationDataSource&&e[n]){var a={};a[this.relationField]=e[n];var o=t.sender;$(o).data("silent",!0),this.relationDataSource.startInserting(a,function(){this.postSilent()}.bind(this.relationDataSource))}evtSelect&&evtSelect()}.bind(relactionDS),options.change=attrs.onChange?function(){eval(attrs.onChange)}:void 0,options.close=attrs.onClose?function(){eval(attrs.onClose)}:void 0,options.dataBound=attrs.onDatabound?function(){eval(attrs.onDatabound)}:void 0,options.filtering=attrs.onFiltering?function(){eval(attrs.onFiltering)}:void 0,options.open=attrs.onOpen?function(){eval(attrs.onOpen)}:void 0,options.cascade=attrs.onCascade?function(){eval(attrs.onCascade)}:void 0,evtSelect=attrs.onSelect?function(){eval(attrs.onSelect)}:void 0,deselect=attrs.onDeselect?function(){eval(attrs.onDeselect)}:void 0;var combobox=$element.kendoMultiSelect(options).data("kendoMultiSelect"),convertArray=function(e){var t=[];if(e)for(var n in e)t.push(e[n][relactionDS.relationField]);return t};scope.$watchCollection(function(){return ngModelCtrl.$modelValue},function(e,t){var n=$(combobox).data("silent");$(combobox).data("silent",!1),n||JSON.stringify(e)===JSON.stringify(t)||combobox.value(convertArray(e))})}}}]).directive("cronAutoComplete",["$compile",function(){return{restrict:"E",require:"ngModel",link:function(e,t,n,a){var o={};try{o=JSON.parse(n.options)}catch(e){console.log("AutoComplete invalid configuration! "+e)}try{delete r.dataSource.schema.model.id}catch(t){}var r=app.kendoHelper.getConfigCombobox(o,e);r.change=n.ngChange?function(){e.$eval(n.ngChange)}:void 0,r.close=n.ngClose?function(){e.$eval(n.ngClose)}:void 0,r.dataBound=n.ngDataBound?function(){e.$eval(n.ngDataBound)}:void 0,r.filtering=n.ngFiltering?function(){e.$eval(n.ngFiltering)}:void 0,r.open=n.ngOpen?function(){e.$eval(n.ngOpen)}:void 0,r.select=n.ngSelect?function(){e.$eval(n.ngSelect)}:void 0;var l=t.parent(),d=n.id?" id=\""+n.id+"\"":"",s=n.name?" name=\""+n.name+"\"":"",c="";(n.ngRequired||n.required)&&(c=" required "),$(l).append("<input style=\"width: 100%;\" "+d+s+c+" class=\"cronAutoComplete\" ng-model=\""+n.ngModel+"\"/>");var p=$(l).find("input.cronAutoComplete");$(t).remove(),r.change=function(){e.$apply(function(){a.$setViewValue(p.val())})};var u=p.kendoAutoComplete(r).data("kendoAutoComplete");a&&(a.$formatters.push(function(e){return u.value(e),e}),a.$parsers.push(function(e){if(e){if("string"==typeof e)return e;if(e[o.dataTextField])return e[o.dataTextField]}return null}))}}}]).directive("cronDate",["$compile","$translate","$window",function(e,t){return{restrict:"AE",require:"?ngModel",link:function(e,n,a,o){var r={},l={};try{if(a.options)l=JSON.parse(a.options);else{var d=window.buildElementOptions(n);l=JSON.parse(d)}l.format||(l.format=parseMaskType(l.type,t)),r=app.kendoHelper.getConfigDate(t,l)}catch(e){console.log("AutoComplete invalid configuration! "+e)}var s="date"==r.type||"datetime"==r.type||"time"==r.type,c=$(n);if(!c.data("alreadycompiled")){if(c.data("alreadycompiled",!0),a.fromGrid)c=$(n);else{var p=n.parent(),u=$("<input style=\"width: 100%;\" class=\"cronDate\" ng-model=\""+a.ngModel+"\"/>");$(p).append(u),c=$(p).find("input.cronDate"),c.data("type",r.type),c.attr("type","date")}var g=app.kendoHelper.buildKendoMomentPicker(c,r,e,o);if(a.fromGrid){var m=c.data("initial-date"),f=function(){var e=null,t=$(this).val();m&&(t=m,m=void 0),e=s?moment.utc(t,r.momentFormat):moment(t,r.momentFormat),g.value(e.format(r.momentFormat)),$(this).data("rawvalue",e.toDate())};$(n).on("keydown",f).on("keyup",f).on("change",f),f.bind(c)()}else o&&(o.$formatters.push(function(e){var t=null;if(e){var n=null;n=s?moment.utc(e):moment(e),t=n.format(r.momentFormat)}return g.value(t),t}),o.$parsers.push(function(e){if(e){var t=null;return t=s?moment.utc(g._oldText,r.momentFormat):moment(g._oldText,r.momentFormat),t.toDate()}return null})),$(n).remove()}}}}]).directive("cronSlider",["$compile",function(e){return{restrict:"E",require:"ngModel",getActive:function(e,t){if(e&&e.indexOf(".active."))try{return t.$eval(e.substr(0,e.indexOf(".active.")))}catch(t){}},link:function(t,n,a,o){var r={};try{r=JSON.parse(a.options)}catch(e){console.log("Slider invalid configuration! "+e)}var l=app.kendoHelper.getConfigSlider(r),d=this.getActive(a.ngModel,t);l.change=function(){t.$apply(function(){var e=$(n).val();d&&(e=d.normalizeValue(e,!0)),o.$setViewValue(e),a.ngChange&&t.$eval(a.ngChange)})},l.slide=a.ngSlide?function(){t.$eval(a.ngSlide)}:void 0;var r=$(n).kendoSlider(l).data("kendoSlider");if(a.ngRequired||a.required){var s=a.id?" id=\"input"+app.common.generateId()+"\"":"",c=a.name?" name=\"input"+app.common.generateId()+"\"":"",p=n.parent();$(p).append("<input autocomplete=\"off\" tabindex=\"-1\" style=\"width: 100%;\""+s+c+" required class=\"cronSlider cron-select-offscreen\" ng-model=\""+a.ngModel+"\"/>");var u=$(p).find("input.cronSlider");e(u)(n.scope())}t.$watch(function(){return o.$modelValue},function(e,t){e!==t&&(e?r.value(e):r.value(r.min()))}),o&&(o.$formatters.push(function(e){var t=null;return!e&&r.min?t=r.min:e&&(t=e),r.value(t),t}),o.$parsers.push(function(e){return e?e:null}))}}}]).directive("cronSwitch",["$compile",function(){return{restrict:"E",require:"ngModel",link:function(e,t,n,a){var o={};try{var r=window.buildElementOptions(t);o=JSON.parse(r)}catch(e){console.log("Switch invalid configuration! "+e)}var l=app.kendoHelper.getConfigSwitch(o),d=t.parent();$(d).append("<input style=\"width: 100%;\" class=\"cronSwitch\" ng-model=\""+n.ngModel+"\"/>");var s=$(d).find("input.cronSwitch");l.change=function(){e.$apply(function(){a.$setViewValue(this.value())}.bind(this))};var c=s.kendoMobileSwitch(l).data("kendoMobileSwitch");$(t).remove(),a&&(a.$formatters.push(function(e){var t=!1;return null!=e&&(t=e),c.value(t),t}),a.$parsers.push(function(e){return null!=e&&e}))}}}]).directive("cronBarcode",["$compile",function(){return{restrict:"E",require:"ngModel",link:function(e,t,n,a){var o={};try{var r=window.buildElementOptions(t);o=JSON.parse(r)}catch(e){console.log("Barcode invalid configuration! "+e)}var l=app.kendoHelper.getConfigBarcode(o),d=t.parent();$(d).append("<span class=\"cronBarcode\" ng-model=\""+n.ngModel+"\"></span>");var s=$(d).find("span.cronBarcode"),c=s.kendoBarcode(l).data("kendoBarcode");$(t).remove(),e.$watch(function(){return a.$modelValue},function(e,t){var n="";e!==t&&(n=e),l.value=n,c.setOptions(l)})}}}]).directive("cronQrcode",["$compile",function(){return{restrict:"E",require:"ngModel",link:function(e,t,n,a){var o={};try{var r=window.buildElementOptions(t);o=JSON.parse(r)}catch(e){console.log("Qrcode invalid configuration! "+e)}var l=app.kendoHelper.getConfigQrcode(o),d=t.parent();$(d).append("<span class=\"cronQrcode\" ng-model=\""+n.ngModel+"\"></span>");var s=$(d).find("span.cronQrcode"),c=s.kendoQRCode().data("kendoQRCode");$(t).remove(),e.$watch(function(){return a.$modelValue},function(e,t){var n="";e!==t&&(n=e),l.value=n,c.setOptions(l)})}}}]).directive("cronappRating",[function(){'use strict';return{restrict:"E",require:"ngModel",link:function(e,t,n,a){function o(e){for(var t=1;5>=t;t++)s[t-1].removeClass(n.iconOff||"fa fa-star-o"),s[t-1].removeClass(n.iconOn),s[t-1].removeClass(n.theme),t<=e?(s[t-1].addClass(n.iconOn),s[t-1].addClass(n.theme)):(s[t-1].addClass(n.iconOff||"fa fa-star-o"),s[t-1].addClass(n.theme));return e}n.theme=$(t).find("i").attr("xattr-theme"),n.iconOn=$(t).find("i").attr("class");var r=$(t),l=$("<i style=\"font-size: 200%\" class=\"component-holder\" data-component=\"crn-icon\" xattr-theme=\"\"></i>");l.addClass(n.iconOff||"fa fa-star-o"),r.html("");for(var d,s=[],c=1;5>=c;c++)d=l.clone(),r.append(d),d.attr("idx",c),d.click(function(){e.$apply(function(){a.$viewValue=parseInt($(this).attr("idx")),a.$commitViewValue()}.bind(this))}),s.push(d);a.$parsers.push(o),a.$formatters.push(o)}}}]).directive("cronDynamicMenu",["$compile",function(e){'use strict';return{restrict:"EA",populateItems:function(e){var t="";return e&&null!=e&&Array.isArray(e)&&(e.forEach(function(e){var n=e.security&&null!=e.security?" cronapp-security=\""+e.security+"\" ":"",a=e.action&&null!=e.action?" ng-click=\""+e.action+"\" ":"",o=e.hide&&null!=e.hide?" ng-hide=\""+e.hide+"\" ":"",r=e.iconClass&&null!=e.iconClass?"<i class=\""+e.iconClass+"\"></i>":"",l="<span>"+e.title+"</span>";t=t+"<li"+o+"><a href=\"\""+n+a+">"+r+l+"</a></li>"}),""!=t&&(t="<ul class=\"dropdown-menu\">"+t+"</ul>")),t},populateMenu:function(e){var t="";if(e&&null!=e&&e.subMenuOptions&&null!=e.subMenuOptions&&Array.isArray(e.subMenuOptions)){var n=this.populateItems;e.subMenuOptions.forEach(function(e){var a=e.security&&null!=e.security?" cronapp-security=\""+e.security+"\" ":"",o=e.action&&null!=e.action?" ng-click=\""+e.action+"\" ":"",r=e.menuItems&&Array.isArray(e.menuItems)&&0<e.menuItems.length?"<span class=\"caret\"></span>":"",l=e.hide&&null!=e.hide?" ng-hide=\""+e.hide+"\" ":"",d=e.iconClass&&null!=e.iconClass?"<i class=\""+e.iconClass+"\"></i>":"",s="<span>"+e.title+"</span>";t=t+"              <li class=\"dropdown component-holder crn-menu-item\" data-component=\"crn-menu-item\""+a+l+">                <a href=\"\" "+o+" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">                "+d+s+r+n(e.menuItems)+"                </a>               </li>"})}return t},link:function(t,n,a){var o={};try{o=JSON.parse(a.options)}catch(t){console.log("CronDynamicMenu: Invalid configuration!")}var r=$("<ul class=\"nav navbar-nav\" style=\"float:none\"></ul>"),l=this.populateMenu(o);r.append(l);var d=angular.element(r);n.html(""),n.append(r),n.attr("id",null),e(d)(t)}}}]).directive("ngInitialValue",["$parse",function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a){if(a.ngInitialValue){var o,r=e(a.ngModel),l=r.assign;try{o=t.$eval(a.ngInitialValue)}catch(t){o=a.ngInitialValue}"checkbox"==n[0].type&&o&&(o="true"==(""+o).toLowerCase()),l(t,o)}}}}]).directive("crnAllowNullValues",[function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,a){"true"==n.crnAllowNullValues&&(a.$formatters=[],a.$parsers=[],a.$render=function(){var e=a.$viewValue;t.data("checked",e);!0===e?(t.prop("indeterminate",!1),t.prop("checked",!0)):!1===e?(t.prop("indeterminate",!1),t.prop("checked",!1)):t.prop("indeterminate",!0)},t.bind("click",function(){var n;switch(t.data("checked")){case!1:n=!0;break;case!0:n=null;break;default:n=!1;}a.$setViewValue(n),e.$apply(a.$render)}))}}}])}(app);function maskDirectiveAsDate(e,t,n){return maskDirective(e,t,n,"as-date")}function maskDirectiveMask(e,t,n){return maskDirective(e,t,n,"mask")}function maskDirective(e,t,n,a){return{restrict:"A",require:"?ngModel",link:function(e,o,r,l){if("as-date"!=a||void 0===r.mask){var d=n(r.ngModel),s=d.assign,c=$(o);if(!c.data("alreadycompiled")){c.data("alreadycompiled",!0);var p=c.attr("type");if("checkbox"!=p&&"password"!=p){c.data("type",p),c.attr("type","text"),l&&(l.$formatters=[],l.$parsers=[]),void 0!==r.asDate&&"text"==p&&(p="date");var u=!1,g=r.mask||r.format;g=g?parseMaskType(g,t):parseMaskType(p,t),g.endsWith(";0")&&(u=!0);var m=g.replace(";1","").replace(";0","").trim();if(null!=m&&0!=m.length)if("date"==p||"datetime"==p||"datetime-local"==p||"month"==p||"time"==p||"time-local"==p||"week"==p){var f={format:m,locale:t.use(),showTodayButton:!0,useStrict:!0,tooltips:{today:t.instant("DatePicker.today"),clear:t.instant("DatePicker.clear"),close:t.instant("DatePicker.close"),selectMonth:t.instant("DatePicker.selectMonth"),prevMonth:t.instant("DatePicker.prevMonth"),nextMonth:t.instant("DatePicker.nextMonth"),selectYear:t.instant("DatePicker.selectYear"),prevYear:t.instant("DatePicker.prevYear"),nextYear:t.instant("DatePicker.nextYear"),selectDecade:t.instant("DatePicker.selectDecade"),prevDecade:t.instant("DatePicker.prevDecade"),nextDecade:t.instant("DatePicker.nextDecade"),prevCentury:t.instant("DatePicker.prevCentury"),nextCentury:t.instant("DatePicker.nextCentury")}};"DD/MM/YYYY"!=m&&"MM/DD/YYYY"!=m&&(f.sideBySide=!0);var h="date"==p||"datetime"==p||"time"==p;if(c.attr("from-grid")){var b=function(){var e=$(this).offset(),t=!0,n=$(this).parent().find(".bootstrap-datetimepicker-widget.dropdown-menu.usetwentyfour.bottom");if(n.length||(t=!1,n=$(this).parent().find(".bootstrap-datetimepicker-widget.dropdown-menu.usetwentyfour.top")),$(n).offset()){var a=$(n).offset().left,o=$("body");n.appendTo(o);var r=0;r=t?e.top+35:e.top-($(n).height()+15),n.css("top",r),n.css("bottom","auto"),n.css("left",a),n.css("z-index",999999)}};if(c.on("click",b),c.on("focus",function(){setTimeout(b.bind(this),100)}),c.on("dp.change",function(){var e=null;e=h?moment.utc(c.val(),m):moment(c.val(),m),c.data("rawvalue",e.toDate())}),c.data("initial-value")){var v=c.data("initial-value"),y=null;y=h?moment.utc(v):moment(v),c.val(y.format(m)),c.data("initial-value",null)}}else c.wrap("<div style=\"position:relative\"></div>");c.datetimepicker(f),c.on("dp.change",function(){$(this).is(":visible")&&($(this).trigger("change"),e.$apply(function(){var t=c.val(),n=null;n=h?moment.utc(t,m):moment(t,m),n.isValid()&&l&&s(e,n.toDate())}))}),l&&(l.$formatters.push(function(e){if(e){var t=null;return h?(t=moment.utc(e),!t.isValid()&&(t=moment.utc(e,m))):(t=moment(e),!t.isValid()&&(t=moment(e,m))),t.format(m)}return null}),l.$parsers.push(function(e){if(e){if(e instanceof Date)return e;var t=null;return t=h?moment.utc(e,m):moment(e,m),t.toDate()}return null}))}else if("number"==p||"money"==p||"integer"==p||"money-decimal"==p){u=!0;var k=m.trim().replace(/\./g,"").replace(/\,/g,"").replace(/#/g,"").replace(/0/g,"").replace(/9/g,""),S="",C="",w="",D=",",M=0;m.startsWith(k)?S=k:m.endsWith(k)&&(C=k);var x=m.trim().replace(S,"").replace(C,"").trim();x.startsWith("#.")?w=".":x.startsWith("#,")&&(w=",");var T=null;if(-1==x.indexOf(",0")?-1!=x.indexOf(".0")&&(D=".",T=".0"):(D=",",T=",0"),null!=T){var F=x.substring(x.indexOf(T)+1);M=F.length}var E="numeric";0==M&&(E="integer"),"money-decimal"==p&&(E="currency");var I={rightAlign:"money"==p||"money-decimal"==p,unmaskAsNumber:!0,allowMinus:!0,prefix:S,suffix:C,radixPoint:D,digits:M,numericInput:"money-decimal"==p};w&&(I.autoGroup=!0,I.groupSeparator=w),$(o).inputmask(E,I);var P=function(){$(this).data("rawvalue",$(this).inputmask("unmaskedvalue"))};$(o).on("keydown",P).on("keyup",P),l&&(l.$formatters.push(function(e){return null!=e&&null!=e&&""!=e?format(m,e):null}),l.$parsers.push(function(e){if(null!=e&&null!=e&&""!=e){var t=c.inputmask("unmaskedvalue");if(""!=t)return t}return null}))}else if("text"==p||"tel"==p){var f={};r.maskPlaceholder&&(f.placeholder=r.maskPlaceholder),c.mask(m,f);var P=function(){u&&$(this).data("rawvalue",$(this).cleanVal())};$(o).on("keydown",P).on("keyup",P),u&&l&&(l.$formatters.push(function(e){return e?c.masked(e):null}),l.$parsers.push(function(e){return e?c.cleanVal():null}))}else if(c.attr("from-grid")){var P=function(){$(this).data("rawvalue",$(this).val())};$(o).on("keydown",P).on("keyup",P)}}}}}}}function parseMaskType(e,t){return"datetime"==e||"datetime-local"==e?(e=t.instant("Format.DateTime"),"Format.DateTime"==e&&(e="DD/MM/YYYY HH:mm:ss")):"date"==e?(e=t.instant("Format.Date"),"Format.Date"==e&&(e="DD/MM/YYYY")):"time"==e||"time-local"==e?(e=t.instant("Format.Hour"),"Format.Hour"==e&&(e="HH:mm:ss")):"month"==e?e="MMMM":"number"==e?(e=t.instant("Format.Decimal"),"Format.Decimal"==e&&(e="#.#00,00")):"money"==e||"money-decimal"==e?(e=t.instant("Format.Money"),"Format.Money"==e&&(e="#.#00,00")):"integer"==e?(e=t.instant("Format.Integer"),"Format.Integer"==e&&(e="###,###.")):"week"==e?e="dddd":"tel"==e?e="(00) 00000-0000;0":"text"==e&&(e=""),e}app.kendoHelper={getSchema:function(e){var t=[{kendoType:"string",entityType:["string","character","uuid","guid"]},{kendoType:"number",entityType:["integer","long","double","int","float","bigdecimal","single","int32","int64","decimal","byte"]},{kendoType:"date",entityType:["date","time","datetime"]},{kendoType:"boolean",entityType:["boolean"]}],n=function(e){for(var n=0;n<t.length;n++)if(t[n].entityType.includes(e.toLocaleLowerCase()))return t[n].kendoType;return"string"},a={model:{id:"__$id",fields:{}}};return e&&e.schemaFields&&(e.schemaFields.forEach(function(e){a.model.fields[e.name]={type:n(e.type),editable:!0,nullable:e.nullable,validation:{required:!e.nullable}}}),a.model.fields.__$id={type:"string",editable:!0,nullable:!0,validation:{required:!1}}),a},getDataSource:function(t,n,a,o,r,l){function d(e){for(var t=0;t<e.length;t++)r&&r.forEach(function(n){if("Database"==n.dataType){var a="datetime-local"==n.type||"month"==n.type||"time-local"==n.type||"week"==n.type;a&&e[t][n.field]&&(e[t][n.field]=e[t][n.field].replace(/\d+/,function(e){return parseInt(e)+u}))}})}var s=this.getSchema(t);r&&r.forEach(function(e){for(var t in s.model.fields)if("Database"==e.dataType&&e.field==t){s.model.fields[t].nullable=!e.required,s.model.fields[t].validation.required=e.required;break}});var c=function(e){for(var t in e)if(s.model.fields.hasOwnProperty(t)){var n=s.model.fields[t];"string"==n.type&&null!=e[t]?e[t]+="":"number"==n.type&&null!=e[t]?e[t]=parseFloat(e[t]):"date"==n.type&&null!=e[t]?e[t]="/Date("+e[t].getTime()+")/":"boolean"==n.type&&(null==e[t]?e[t]=!1:e[t]="true"==e[t].toString().toLowerCase()),s.model.id==t&&null!=e[t]&&0==e[t].toString().length&&delete e[t]}return e},p=10;n[t.name]&&(p=n[t.name].rowsPerPage);var u=6e4*new Date().getTimezoneOffset(),g=app.common.generateId(),m={transport:{setActiveAndPost:function(t){var e=this.options.cronappDatasource;n.safeApply(e.updateActive(c(t.data))),e.active.__sender=g,e.postSilent(function(e){this.options.enableAndSelect(t),t.success(e),this.options.grid.dataSource._pristineTotal=this.options.grid.dataSource._pristineData.push(e)}.bind(this),function(e){this.options.enableAndSelect(t),t.error(e,e,e)}.bind(this))},push:function(e){!this.options.dataSourceEventsPush&&this.options.cronappDatasource&&(this.options.dataSourceEventsPush={create:function(t){if(this.options.isGridInDocument(this.options.grid)){var n=this.options.getCurrentCallbackForPush(e,this.options.grid);n.pushUpdate(t)}else this.options.cronappDatasource.removeDataSourceEvents(this.options.dataSourceEventsPush)}.bind(this),update:function(t){if(this.options.isGridInDocument(this.options.grid)){var n=this.options.getCurrentCallbackForPush(e,this.options.grid);n.pushUpdate(t)}else this.options.cronappDatasource.removeDataSourceEvents(this.options.dataSourceEventsPush)}.bind(this),delete:function(t){if(this.options.isGridInDocument(this.options.grid)){var n=this.options.getCurrentCallbackForPush(e,this.options.grid);n.pushDestroy(t)}else this.options.cronappDatasource.removeDataSourceEvents(this.options.dataSourceEventsPush)}.bind(this),overRideRefresh:function(){this.options.isGridInDocument(this.options.grid)&&this.options.grid.dataSource.read()}.bind(this),read:function(){this.options.isGridInDocument(this.options.grid)&&(this.options.fromRead=!0,this.options.grid.dataSource.read())}.bind(this),memorycreate:function(t){if(this.options.isGridInDocument(this.options.grid)){var n=this.options.getCurrentCallbackForPush(e,this.options.grid);n.pushUpdate(t)}else this.options.cronappDatasource.removeDataSourceEvents(this.options.dataSourceEventsPush)}.bind(this),memoryupdate:function(t){if(this.options.isGridInDocument(this.options.grid)){var n=this.options.getCurrentCallbackForPush(e,this.options.grid);n.pushUpdate(t)}else this.options.cronappDatasource.removeDataSourceEvents(this.options.dataSourceEventsPush)}.bind(this),memorydelete:function(t){if(this.options.isGridInDocument(this.options.grid)){var n=this.options.getCurrentCallbackForPush(e,this.options.grid);n.pushDestroy(t)}}.bind(this)},"combobox"==this.origin&&delete this.options.dataSourceEventsPush.overRideRefresh,this.options.cronappDatasource.addDataSourceEvents(this.options.dataSourceEventsPush))},read:function(n){var e=!1;try{var a=this.options.cronappDatasource,o=this.options.grid;this.options.kendoCallback?this.options.fromRead?this.options.kendoCallback.success(a.data):e=!0:(this.options.kendoCallback=n,e=!0)}finally{this.options.fromRead=!1}if(e){for(key in n.data)null==n.data[key]&&delete n.data[key];var r=kendo.data.transports.odata.parameterMap(n.data,"read"),l="";this.options.grid&&this.options.grid.dataSource.group().forEach(function(e){l+=e.field+" "+e.dir+","}),0<l.length&&(l=l.substr(0,l.length-1),r.$orderby=r.$orderby?l+","+r.$orderby:l);var a=this.options.cronappDatasource;if(a.rowsPerPage=n.data.pageSize,a.offset=n.data.page-1,!n.data.pageSize&&(a.offset=void 0,delete r.$skip,this.options.grid&&1!=this.options.grid.dataSource.page()))return this.options.grid.dataSource.page(1),void n.error("canceled","canceled","canceled");var d=!1;t.append&&(d=t.append),a.append=d,a.fetch({params:r},{success:function(e){n.success(e)},canceled:function(){n.error("canceled","canceled","canceled")}},d)}},update:function(t){this.setActiveAndPost(t)},create:function(t){this.setActiveAndPost(t)},destroy:function(t){cronappDatasource=this.options.cronappDatasource,cronappDatasource.removeSilent(t.data,function(e){t.success(e)},function(){t.error("canceled","canceled","canceled")})},batch:function(){},options:{fromRead:!1,disableAndSelect:function(t){this.isGridInDocument(this.grid)&&(this.grid.select(t.container),this.grid.options.selectable=!1,this.grid.selectable&&this.grid.selectable.element&&(this.grid.selectable.destroy(),this.grid.selectable=null))},enableAndSelect:function(t){this.isGridInDocument(this.grid)&&(this.grid.options.selectable=this.grid.options.originalSelectable,this.grid._selectable(),this.grid.select(t.container))},selectActiveInGrid:function(){if(this.isGridInDocument(this.grid)&&this.grid.selectable&&0<this.grid.dataItems().length&&this.cronappDatasource.active&&this.cronappDatasource.active.__$id){for(var e=this.grid.dataItems(),t=-1,n=0;n<e.length;n++)if(this.cronappDatasource.active.__$id==e[n].__$id){t=n;break}-1<t&&!this.grid.selectable.options.multiple&&this.grid.select(this.grid.table.find("tr")[t])}},isGridInDocument:function(e){return!!e&&$(document).has(e.element[0]).length},getCurrentCallbackForPush:function(e,t){return e?e:t},cronappDatasource:n[t.name]}},pageSize:p,serverPaging:!0,serverFiltering:!0,serverSorting:!0,batch:!1,schema:s,requestEnd:function(t){if(t.response&&t.response.d){var e=null;e=t.response.d.results?t.response.d.results:[t.response.d],this.group().length?r.forEach(function(t){if("Database"==t.dataType){var n="datetime-local"==t.type||"month"==t.type||"time-local"==t.type||"week"==t.type;if(n)for(var a,o=0;o<e.length;o++)a=e[o],t.field==a.Member&&(a.Key=a.Key.replace(/\d+/,function(e){return parseInt(e)+u})),d.bind(this)(a.Items)}}):d.bind(this)(e)}}};return m.aggregate=function(e){var t=[];return e&&e.forEach(function(e){e.aggregates&&e.aggregates.forEach(function(n){t.push({field:e.field,aggregate:n.type})})}),t}(r),m.schema.total=function(){return m.transport.options.cronappDatasource.getRowsCount()},l&&(m.group=[],l.forEach(function(e){var t={field:e.field,aggregates:m.aggregate};m.group.push(t)})),m},getEventReadCombo:function(t){var e=this.options.cronappDatasource;if(!e)return void t.error("canceled","canceled","canceled");var n;if(this.options.combobox&&this.options.combobox.options.readData)return t.success(this.options.combobox.options.readData),this.options.combobox.options.readData=null,void(this.options.alreadyLoaded=!0);if(this.options.combobox)var n=!this.options.alreadyLoaded;else n=!1;this.options.alreadyLoaded=!0;var a=!0;if(n&&(a=!1,e.lazy?t.success([{}]):t.success([])),a){for(key in t.data)null==t.data[key]&&delete t.data[key];var o=kendo.data.transports.odata.parameterMap(t.data,"read");e.rowsPerPage=t.data.pageSize,e.offset=t.data.page-1;var r=this,l={};l.params=o,r.options.combobox&&(r.options.combobox.options.fromCombo=!0),e.fetch(l,{success:function(e){if(t.success&&(t.success(e),r.options&&r.options.combobox&&r.options.combobox.element[0].id)){var n=angular.element($(" .k-animation-container"));r.options.$compile(n)(r.options.scope)}},canceled:function(){r.options.combobox&&(r.options.combobox.options.fromCombo=!1),t.success&&t.error("canceled","canceled","canceled")},error:function(){r.options.combobox&&(r.options.combobox.options.fromCombo=!1),t.success&&t.error("error","error","error")}},!1,{ignoreAtive:!0})}},getConfigCombobox:function(e,t){var n=!1,a={},a={},o={};if(e){if(!e.dynamic||"false"==e.dynamic)for(n=!0,e.dataValueField=e.dataValueField||"value",e.dataTextField=e.dataTextField||"key",a.data=null==e.staticDataSource?void 0:e.staticDataSource,i=0;i<a.data.length;i++)try{a.data[i].key=t.$eval(a.data[i].key)}catch(t){a.data[i].key=a.data[i].key}else e.dataSourceScreen&&e.dataSourceScreen.entityDataSource&&(e.dataSourceScreen.entityDataSource.append=!0,a=app.kendoHelper.getDataSource(e.dataSourceScreen.entityDataSource,t,!0,e.dataSourceScreen.rowsPerPage),a.transport.read=app.kendoHelper.getEventReadCombo,n=null!=e.valuePrimitive&&("string"==typeof e.valuePrimitive?"true"==e.valuePrimitive:e.valuePrimitive));e.dataValueField&&""!=e.dataValueField.trim()||(e.dataValueField=null==e.dataTextField?void 0:e.dataTextField);var r=function(t){var n=e.dataSourceScreen.entityDataSource.schemaFields;for(count=0;count<n.length;count++)if(t==n[count].name){return n[count].type.toLowerCase()}return null};!e.template&&e.format&&(e.template="#= useMask("+e.dataTextField+",'"+e.format+"','"+r(e.dataTextField)+"') #"),!e.valueTemplate&&e.format&&(e.valueTemplate="#= useMask("+e.dataTextField+",'"+e.format+"') #");var o={dataTextField:null==e.dataTextField?void 0:e.dataTextField,dataValueField:null==e.dataValueField?void 0:e.dataValueField,dataSource:a,headerTemplate:null==e.headerTemplate?void 0:e.headerTemplate,template:null==e.template?void 0:e.template,placeholder:null==e.placeholder?void 0:e.placeholder,footerTemplate:null==e.footerTemplate?void 0:e.footerTemplate,filter:null==e.filter?void 0:e.filter,valuePrimitive:n,optionLabel:null==e.optionLabel||""==e.optionLabel?" ":e.optionLabel,valueTemplate:null==e.valueTemplate?void 0:e.valueTemplate,suggest:!0}}return o},getConfigDate:function(e,t){var n={};if(n){var a=function(e){e=e.replace(/_/gm,"-");var t=e.split("-");return t[t.length-1]=t[t.length-1].toUpperCase(),t.join("-")},o=function(e){return e&&(e=e.replace(/:MM/gm,":mm"),e=e.replace(/:M/gm,":m"),e=e.replace(/S/gm,"s"),e=e.replace(/D/gm,"d"),e=e.replace(/Y/gm,"y")),e},r=function(t,n){return null==n&&(n=parseMaskType(t,e)),n},l={};if(t.animation)try{l=JSON.parse(t.animation)}catch(e){console.log("DateAnimation invalid configuration! "+e)}var d=r(t.type,t.format),s=o(d),c=o(t.timeFormat),p=a(e.use());n={value:null,format:s,timeFormat:c,momentFormat:d,culture:p,type:null==t.type?void 0:t.type,weekNumber:null==t.weekNumber?void 0:t.weekNumber,dateInput:null==t.dateInput?void 0:t.dateInput,animation:l,footer:null==t.footer?void 0:t.footer,start:null==t.start?void 0:t.start,depth:null==t.start?void 0:t.start}}return n},buildKendoMomentPicker:function(e,t,n,a){var o="date"==t.type||"datetime"==t.type||"time"==t.type;if(!e.attr("from-grid")){var r=function(){var n=e.val();if(!n||""==n.trim())a&&a.$setViewValue("");else{var r=null;r=o?moment.utc(n,t.momentFormat):moment(n,t.momentFormat),a&&r.isValid()&&(a.$setViewValue(r.toDate()),e.data("changed",!0))}};t.change=n?function(){n.$apply(function(){r()})}:r}return"date"==t.type?e.kendoDatePicker(t).data("kendoDatePicker"):"datetime"==t.type||"datetime-local"==t.type?e.kendoDateTimePicker(t).data("kendoDateTimePicker"):"time"==t.type||"time-local"==t.type?e.kendoTimePicker(t).data("kendoTimePicker"):void 0},getConfigSlider:function(e){e=e||{};var t={increaseButtonTitle:e.increaseButtonTitle,decreaseButtonTitle:e.decreaseButtonTitle,dragHandleTitle:e.dragHandleTitle};try{t.min=e.min?parseInt(e.min):1,t.max=e.max?parseInt(e.max):1,t.smallStep=e.smallStep?parseInt(e.smallStep):1,t.largeStep=e.largeStep?parseInt(e.largeStep):1}catch(e){console.log("Slider invalid configuration! "+e)}return t},getConfigSwitch:function(e){e=e||{};var t={onLabel:null==e.onLabel?void 0:e.onLabel,offLabel:null==e.offLabel?void 0:e.offLabel};return t},getConfigBarcode:function(e){var t={type:null==e.type?void 0:e.type,width:null==e.width?void 0:parseInt(e.width),height:null==e.height?void 0:parseInt(e.height)};return t.type||(t.type="EAN8"),t},getConfigQrcode:function(e){var t={errorCorrection:null==e.errorCorrection?void 0:e.errorCorrection,size:null==e.size?void 0:parseInt(e.size),color:null==e.color?void 0:e.color};return(e.borderColor||e.borderSize)&&(t.border={size:null==e.size?void 0:parseInt(e.size),color:null==e.color?void 0:e.color}),t}},window.showTreatedValue=function(e){return e?e:""},window.useMask=function(e,t,n){var a="";t="null"==t||"undefined"==t?void 0:t;var o=e,r=t||n;return null!=e&&null!=e&&(o=e instanceof Date?"\""+e.toISOString()+"\"":"number"==typeof e?e:"\""+e+"\"",a="{{ "+o+"  | mask:\""+r+"\"}}"),a};